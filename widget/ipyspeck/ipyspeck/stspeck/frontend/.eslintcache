[{"/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/index.tsx":"1","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/view.js":"2","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/colors.js":"3","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/interactions.js":"4","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/system.js":"5","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/renderer.js":"6","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/webgl.js":"7","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/const.js":"8","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/gl-matrix.js":"9","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/elements.js":"10","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/shaders.js":"11","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/cube.js":"12"},{"size":20503,"mtime":1715891039007,"results":"13","hashOfConfig":"14"},{"size":4919,"mtime":1715890619494,"results":"15","hashOfConfig":"14"},{"size":13388,"mtime":1653071221434,"results":"16","hashOfConfig":"14"},{"size":3457,"mtime":1653071221659,"results":"17","hashOfConfig":"14"},{"size":3662,"mtime":1653071221842,"results":"18","hashOfConfig":"14"},{"size":22985,"mtime":1653071221745,"results":"19","hashOfConfig":"14"},{"size":9938,"mtime":1653071683936,"results":"20","hashOfConfig":"14"},{"size":392,"mtime":1653071221447,"results":"21","hashOfConfig":"14"},{"size":111833,"mtime":1653071882440,"results":"22","hashOfConfig":"14"},{"size":21093,"mtime":1653071221483,"results":"23","hashOfConfig":"14"},{"size":15763,"mtime":1653071221773,"results":"24","hashOfConfig":"14"},{"size":987,"mtime":1653071221466,"results":"25","hashOfConfig":"14"},{"filePath":"26","messages":"27","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"28"},"gwbsj1",{"filePath":"29","messages":"30","errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":1,"source":"31"},{"filePath":"32","messages":"33","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"34","messages":"35","errorCount":0,"fatalErrorCount":0,"warningCount":3,"fixableErrorCount":0,"fixableWarningCount":1,"source":"36"},{"filePath":"37","messages":"38","errorCount":0,"fatalErrorCount":0,"warningCount":8,"fixableErrorCount":0,"fixableWarningCount":1,"source":"39"},{"filePath":"40","messages":"41","errorCount":0,"fatalErrorCount":0,"warningCount":12,"fixableErrorCount":0,"fixableWarningCount":1,"source":"42"},{"filePath":"43","messages":"44","errorCount":0,"fatalErrorCount":0,"warningCount":6,"fixableErrorCount":0,"fixableWarningCount":0,"source":"45"},{"filePath":"46","messages":"47","errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"48"},{"filePath":"49","messages":"50","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"51","messages":"52","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"53","messages":"54","errorCount":0,"fatalErrorCount":0,"warningCount":9,"fixableErrorCount":0,"fixableWarningCount":9,"source":"55"},{"filePath":"56","messages":"57","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/index.tsx",["58"],"import { Streamlit, RenderData } from \"streamlit-component-lib\"\n\nconst speckRenderer = require('./renderer.js');\nconst speckSystem = require('./system.js');\nconst speckView = require('./view.js');\nconst speckInteractions = require('./interactions.js');\nconst speckColors = require('./colors.js');\n\n\nlet system = speckSystem.new();\nlet view = speckView.new();\nview.resolution.x = 200;\nview.resolution.y = 200;\nview.bonds = true;\nview.atomScale = 0.24;\nview.relativeAtomScale = 0.64;\nview.bondScale = 0.5;\nview.brightness = 0.5;\nview.outline = 0.0;\nview.spf = 32;\nview.bondThreshold = 1.2;\nview.bondShade = 0.5;\nview.atomShade = 0.5;\nview.dofStrength = 0.0;\nview.dofPosition = 0.5;\n\nvar renderer: any = null;\nlet needReset = false;\nlet current_schema = \"speck\";\n\n\nlet container = document.createElement(\"div\");\nlet canvas = document.createElement('canvas')\ncanvas.addEventListener('dblclick', function () {\n    center();\n});\nlet topbar = document.createElement('div')\ntopbar.style.top = \"0px\"\ntopbar.style.height = \"30px\"\ntopbar.style.right = \"0px\"\ntopbar.style.position = \"absolute\"\ntopbar.style.background = \"rgba(255,255,255,0.9)\"\ntopbar.style.flexDirection = \"row\";\ntopbar.style.alignContent = \"flex-end\";\ntopbar.style.display = \"flex\";\n\n\nlet infoc = document.createElement(\"div\");\ninfoc.style.fontSize = \"10px\";\ninfoc.style.color = \"#AAA\";\ninfoc.innerHTML = 'Colors: ' + current_schema;\n\n\n\nlet autoscale = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nautoscale.setAttribute('width', \"16\");\nautoscale.setAttribute('height', \"16\");\nautoscale.setAttribute('viewBox', \"0 0 16 16\");\nautoscale.setAttribute('fill', \"#AAAAAA\");\nautoscale.addEventListener('mouseover', function () {\n    autoscale.setAttribute('fill', \"#666666\");\n});\nautoscale.addEventListener('mouseout', function () {\n    autoscale.setAttribute('fill', \"#AAAAAA\");\n});\nautoscale.innerHTML = '<g><path d=\"M 1 5 v -4 h 4 M 15 5 v -4 h -4 M 1 11 v 4 h 4 M 11 15 h 4 v -4 M 5 8 l 3 -3 l 3 3 l -3 3 l -3 -3\"></path></g>';\nautoscale.addEventListener('click', function () {\n    center();\n});\n\nlet autoscalec = document.createElement(\"div\");\nautoscalec.style.padding = \"2px\"\nautoscalec.append(autoscale)\n\nlet camera = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\ncamera.setAttribute('width', \"16\");\ncamera.setAttribute('height', \"16\");\ncamera.setAttribute('viewBox', \"0 0 16 16\");\ncamera.setAttribute('fill', \"#AAAAAA\");\ncamera.addEventListener('mouseover', function () {\n    camera.setAttribute('fill', \"#666666\");\n});\ncamera.addEventListener('mouseout', function () {\n    camera.setAttribute('fill', \"#AAAAAA\");\n});\ncamera.innerHTML = '<g><path d=\"M 10.421875 8.773438 C 10.421875 10.09375 9.355469 11.160156 8.039062 11.160156 C 6.71875 11.160156 5.652344 10.09375 5.652344 8.773438 C 5.652344 7.457031 6.71875 6.390625 8.039062 6.390625 C 9.355469 6.390625 10.421875 7.457031 10.421875 8.773438 Z M 10.421875 8.773438\"></path><path d=\"M 14.746094 4.007812 L 12.484375 4.007812 C 12.289062 4.007812 12.117188 3.929688 11.992188 3.785156 C 10.816406 2.457031 10.371094 2.015625 9.882812 2.015625 L 6.320312 2.015625 C 5.828125 2.015625 5.359375 2.460938 4.15625 3.785156 C 4.035156 3.929688 3.835938 4.007812 3.664062 4.007812 L 3.492188 4.007812 L 3.492188 3.664062 C 3.492188 3.492188 3.347656 3.320312 3.148438 3.320312 L 2.066406 3.320312 C 1.894531 3.320312 1.722656 3.464844 1.722656 3.664062 L 1.722656 4.007812 L 1.398438 4.007812 C 0.664062 4.007812 0 4.546875 0 5.285156 L 0 12.609375 C 0 13.347656 0.664062 13.984375 1.398438 13.984375 L 14.722656 13.984375 C 15.460938 13.984375 16 13.320312 16 12.609375 L 16 5.257812 C 16.023438 4.546875 15.484375 4.007812 14.746094 4.007812 Z M 8.210938 12.335938 C 6.121094 12.433594 4.398438 10.714844 4.496094 8.625 C 4.570312 6.804688 6.042969 5.332031 7.886719 5.234375 C 9.976562 5.136719 11.695312 6.855469 11.601562 8.945312 C 11.503906 10.765625 10.027344 12.242188 8.210938 12.335938 Z M 12.042969 6.414062 C 11.75 6.414062 11.503906 6.167969 11.503906 5.875 C 11.503906 5.582031 11.75 5.335938 12.042969 5.335938 C 12.335938 5.335938 12.585938 5.582031 12.585938 5.875 C 12.585938 6.167969 12.335938 6.414062 12.042969 6.414062 Z M 12.042969 6.414062 \"></path></g>';\ncamera.addEventListener('click', function () {\n    saveSnapshot();\n});\nlet camerac = document.createElement(\"div\");\ncamerac.style.padding = \"2px\"\ncamerac.append(camera)\n\nlet palette = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\npalette.setAttribute('width', \"16\");\npalette.setAttribute('height', \"16\");\npalette.setAttribute('viewBox', \"0 0 16 16\");\npalette.setAttribute('fill', \"#AAAAAA\");\npalette.addEventListener('mouseover', function () {\n    palette.setAttribute('fill', \"#666666\");\n});\npalette.addEventListener('mouseout', function () {\n    palette.setAttribute('fill', \"#AAAAAA\");\n});\npalette.innerHTML = '<g><path d=\"M 7.984375 0.015625 C 3.601562 0.015625 0 3.617188 0 8 C 0 12.382812 3.601562 15.984375 7.984375 15.984375 C 8.742188 15.984375 9.320312 15.402344 9.320312 14.648438 C 9.320312 14.300781 9.175781 13.980469 8.96875 13.75 C 8.738281 13.519531 8.617188 13.226562 8.617188 12.851562 C 8.617188 12.09375 9.199219 11.515625 9.953125 11.515625 L 11.550781 11.515625 C 13.992188 11.515625 15.992188 9.511719 15.992188 7.070312 C 15.972656 3.210938 12.367188 0.015625 7.984375 0.015625 Z M 3.105469 8 C 2.351562 8 1.773438 7.417969 1.773438 6.664062 C 1.773438 5.914062 2.351562 5.332031 3.105469 5.332031 C 3.859375 5.332031 4.441406 5.914062 4.441406 6.664062 C 4.441406 7.417969 3.863281 8 3.105469 8 Z M 5.777344 4.457031 C 5.023438 4.457031 4.445312 3.875 4.445312 3.121094 C 4.445312 2.367188 5.023438 1.789062 5.777344 1.789062 C 6.53125 1.789062 7.113281 2.367188 7.113281 3.121094 C 7.085938 3.878906 6.535156 4.457031 5.777344 4.457031 Z M 10.195312 4.457031 C 9.4375 4.457031 8.859375 3.875 8.859375 3.121094 C 8.859375 2.367188 9.441406 1.789062 10.195312 1.789062 C 10.945312 1.789062 11.527344 2.367188 11.527344 3.121094 C 11.527344 3.878906 10.945312 4.457031 10.195312 4.457031 Z M 12.863281 8 C 12.105469 8 11.527344 7.417969 11.527344 6.664062 C 11.527344 5.914062 12.109375 5.332031 12.863281 5.332031 C 13.617188 5.332031 14.195312 5.914062 14.195312 6.664062 C 14.195312 7.417969 13.617188 8 12.863281 8 Z M 12.863281 8\"/></g>';\npalette.addEventListener('click', function () {\n    switchColorSchema();\n    infoc.innerHTML = 'Colors: <BR>' + current_schema;\n});\nlet palettec = document.createElement(\"div\");\npalettec.style.padding = \"2px\"\npalettec.append(palette)\n\nlet front = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nfront.setAttribute('width', \"16\");\nfront.setAttribute('height', \"16\");\nfront.setAttribute('viewBox', \"0 0 16 16\");\nfront.setAttribute('fill', \"#AAAAAA\");\nfront.setAttribute('stroke', \"#AAAAAA\");\nfront.addEventListener('mouseover', function () {\n    front.setAttribute('fill', \"#666666\");\n    front.setAttribute('stroke', \"#666666\");\n});\nfront.addEventListener('mouseout', function () {\n    front.setAttribute('fill', \"#AAAAAA\");\n    front.setAttribute('stroke', \"#AAAAAA\");\n});\nfront.innerHTML = '<g><path d=\"M 0 5 h 10 v 10 h -10 v -10\" fill=\"none\"/><path d=\"M 4 0 h 10 l -4 4 h -10 l -4 4\" stroke=\"none\"/><path d=\"M 11 5 l 4 -4 v 10 l -4 4 v -10\" stroke=\"none\"/></g>';\nfront.addEventListener('click', function () {\n    frontview();\n});\nlet frontc = document.createElement(\"div\");\nfrontc.style.padding = \"2px\"\nfrontc.append(front)\n\nlet top = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\ntop.setAttribute('width', \"16\");\ntop.setAttribute('height', \"16\");\ntop.setAttribute('viewBox', \"0 0 16 16\");\ntop.setAttribute('fill', \"#AAAAAA\");\ntop.setAttribute('stroke', \"#AAAAAA\");\ntop.addEventListener('mouseover', function () {\n    top.setAttribute('fill', \"#666666\");\n    top.setAttribute('stroke', \"#666666\");\n});\ntop.addEventListener('mouseout', function () {\n    top.setAttribute('fill', \"#AAAAAA\");\n    top.setAttribute('stroke', \"#AAAAAA\");\n});\ntop.innerHTML = '<g><path d=\"M 0 5 h 10 v 10 h -10 v -10\" stroke=\"none\"/><path d=\"M 4 0 h 10 l -4 4 h -10 l -4 4\" fill=\"none\"/><path d=\"M 11 5 l 4 -4 v 10 l -4 4 v -10\" stroke=\"none\"/></g>';\ntop.addEventListener('click', function () {\n    topview();\n});\nlet topc = document.createElement(\"div\");\ntopc.style.padding = \"2px\"\ntopc.append(top)\n\nlet right = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nright.setAttribute('width', \"16\");\nright.setAttribute('height', \"16\");\nright.setAttribute('viewBox', \"0 0 16 16\");\nright.setAttribute('fill', \"#AAAAAA\");\nright.setAttribute('stroke', \"#AAAAAA\");\nright.addEventListener('mouseover', function () {\n    right.setAttribute('fill', \"#666666\");\n    right.setAttribute('stroke', \"#666666\");\n});\nright.addEventListener('mouseout', function () {\n    right.setAttribute('fill', \"#AAAAAA\");\n    right.setAttribute('stroke', \"#AAAAAA\");\n});\nright.innerHTML = '<g><path d=\"M 0 5 h 10 v 10 h -10 v -10\" stroke=\"none\"/><path d=\"M 4 0 h 10 l -4 4 h -10 l -4 4\" stroke=\"none\"/><path d=\"M 11 5 l 4 -4 v 10 l -4 4 v -10\" fill=\"none\"/></g>';\nright.addEventListener('click', function () {\n    rightview();\n});\nlet rightc = document.createElement(\"div\");\nrightc.style.padding = \"2px\"\nrightc.append(right)\n\nlet sti = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nsti.setAttribute('width', \"16\");\nsti.setAttribute('height', \"16\");\nsti.setAttribute('viewBox', \"0 0 16 16\");\nsti.setAttribute('fill', \"#AAAAAA\");\nsti.setAttribute('stroke', \"#AAAAAA\");\nsti.addEventListener('mouseover', function () {\n    sti.setAttribute('fill', \"#666666\");\n    sti.setAttribute('stroke', \"#666666\");\n});\nsti.addEventListener('mouseout', function () {\n    sti.setAttribute('fill', \"#AAAAAA\");\n    sti.setAttribute('stroke', \"#AAAAAA\");\n});\nsti.innerHTML = '<g><circle cx=\"4\" cy=\"4\" r=\"2\"/><circle cx=\"10\" cy=\"2\" r=\"1\"/><circle cx=\"10\" cy=\"12\" r=\"3\"/><path d=\"M 5 5 l 3 4 M 6 3 l 3 -1\" ></path></g>';\nsti.addEventListener('click', function () {\n    stickball();\n    updateModel()\n});\nlet stic = document.createElement(\"div\");\nstic.style.padding = \"2px\"\nstic.append(sti)\n\n\nlet too = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\ntoo.setAttribute('width', \"16\");\ntoo.setAttribute('height', \"16\");\ntoo.setAttribute('viewBox', \"0 0 16 16\");\ntoo.setAttribute('fill', \"#AAAAAA\");\ntoo.setAttribute('stroke', \"#AAAAAA\");\ntoo.addEventListener('mouseover', function () {\n    too.setAttribute('fill', \"#666666\");\n    too.setAttribute('stroke', \"#666666\");\n});\ntoo.addEventListener('mouseout', function () {\n    too.setAttribute('fill', \"#AAAAAA\");\n    too.setAttribute('stroke', \"#AAAAAA\");\n});\ntoo.innerHTML = '<g><circle cx=\"4\" cy=\"4\" r=\"1\"/><circle cx=\"10\" cy=\"2\" r=\"1\"/><circle cx=\"10\" cy=\"12\" r=\"1\"/><path d=\"M 4 5 l 5 6 M 5 3 l 4 -1\" ></path></g>';\ntoo.addEventListener('click', function () {\n    toon();\n    updateModel()\n});\nlet tooc = document.createElement(\"div\");\ntooc.style.padding = \"2px\"\ntooc.append(too)\n\nlet lic = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nlic.setAttribute('width', \"16\");\nlic.setAttribute('height', \"16\");\nlic.setAttribute('viewBox', \"0 0 16 16\");\nlic.setAttribute('fill', \"#AAAAAA\");\nlic.setAttribute('stroke', \"#AAAAAA\");\nlic.addEventListener('mouseover', function () {\n    lic.setAttribute('fill', \"#666666\");\n    lic.setAttribute('stroke', \"#666666\");\n});\nlic.addEventListener('mouseout', function () {\n    lic.setAttribute('fill', \"#AAAAAA\");\n    lic.setAttribute('stroke', \"#AAAAAA\");\n});\nlic.innerHTML = '<g><circle cx=\"4\" cy=\"4\" r=\"2\" fill=\"none\"/><circle cx=\"10\" cy=\"2\" r=\"1\" fill=\"none\"/><circle cx=\"10\" cy=\"12\" r=\"3\" fill=\"none\"/><path d=\"M 5 5 l 3 4 M 6 3 l 3 -1\" ></path></g>';\nlic.addEventListener('click', function () {\n    licorice()\n    updateModel();\n});\nlet licc = document.createElement(\"div\");\nlicc.style.padding = \"2px\"\nlicc.append(lic)\n\nlet fil = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\nfil.setAttribute('width', \"16\");\nfil.setAttribute('height', \"16\");\nfil.setAttribute('viewBox', \"0 0 16 16\");\nfil.setAttribute('fill', \"#AAAAAA\");\nfil.setAttribute('stroke', \"#AAAAAA\");\nfil.addEventListener('mouseover', function () {\n    fil.setAttribute('fill', \"#666666\");\n    fil.setAttribute('stroke', \"#666666\");\n});\nfil.addEventListener('mouseout', function () {\n    fil.setAttribute('fill', \"#AAAAAA\");\n    fil.setAttribute('stroke', \"#AAAAAA\");\n});\nfil.innerHTML = '<g><circle cx=\"4\" cy=\"4\" r=\"2\"/><circle cx=\"10\" cy=\"2\" r=\"1\"/><circle cx=\"10\" cy=\"12\" r=\"3\"/></g>';\nfil.addEventListener('click', function () {\n    fill();\n    updateModel();\n});\nlet filc = document.createElement(\"div\");\nfilc.style.padding = \"2px\"\nfilc.append(fil)\n\n\ncontainer.append(canvas)\n\ntopbar.append(infoc)\n\ntopbar.append(stic)\ntopbar.append(tooc)\ntopbar.append(licc)\ntopbar.append(filc)\n\ntopbar.append(frontc)\ntopbar.append(topc)\ntopbar.append(rightc)\n\ntopbar.append(palettec)\ntopbar.append(camerac)\n\ntopbar.append(autoscalec)\n\ndocument.body.appendChild(topbar);\ndocument.body.appendChild(container);\n\ndocument.body.style.width = \"100%\"\ndocument.body.style.height = \"100%\"\n\nspeckInteractions({\n    container: container,\n    scrollZoom: true,\n    getRotation: function () { return view.rotation },\n    setRotation: function (t: any) { view.rotation = t },\n    getTranslation: function () { return view.translation },\n    setTranslation: function (t: any) { view.translation = t },\n    getZoom: function () { return view.zoom },\n    setZoom: function (t: any) { view.zoom = t },\n    refreshView: function () { needReset = true; }\n});\n\n\nlet saveSnapshot = function () {\n    renderer.render(view);\n    var imgURL = canvas.toDataURL(\"image/png\");\n    var a = document.createElement('a');\n    a.href = imgURL;\n    a.download = \"speck.png\";\n    document.body.appendChild(a);\n    a.click();\n}\n\nlet setAtomsColor = function (atoms: any) {\n    for (const atom in atoms) {\n        if (atom in view.elements) {\n            view.elements[atom].color = atoms[atom];\n            needReset = true;\n        }\n    }\n    if (needReset) {\n        speckSystem.calculateBonds(system, view);\n        renderer.setSystem(system, view);\n    }\n}\n\nlet setColorSchema = function (schema: string) {\n    if (schema in speckColors) {\n        current_schema = schema;\n        setAtomsColor(speckColors[schema]);\n    }\n}\n\nlet switchColorSchema = function () {\n    let update_color = false;\n    let first_color = \"\";\n    for (let color in speckColors) {\n        if (first_color === \"\")\n            first_color = color;\n        if (update_color) {\n            setColorSchema(color);\n            return;\n        }\n        if (color === current_schema) {\n            update_color = true;\n        }\n    }\n    setColorSchema(first_color);\n}\n\nlet stickball = function () {\n    needReset = true;\n    view.atomScale = 0.24;\n    view.relativeAtomScale = 0.64;\n    view.bondScale = 0.5;\n    view.bonds = true;\n    view.bondThreshold = 1.2;\n    view.brightness = 0.5;\n    view.outline = 0.0;\n    view.spf = 32;\n    view.bondShade = 0.5;\n    view.atomShade = 0.5;\n    view.dofStrength = 0.0;\n    view.dofPosition = 0.5;\n    view.ao = 0.75;\n    view.spf = 32;\n    view.outline = 0;\n}\n\nlet toon = function () {\n    stickball()\n    view.atomScale = 0.1;\n    view.relativeAtomScale = 0;\n    view.bondScale = 1;\n    view.bonds = true;\n    view.bondThreshold = 1.2;\n}\n\nlet fill = function () {\n    stickball()\n    view.atomScale = 0.6;\n    view.relativeAtomScale = 1.0;\n    view.bonds = false;\n}\n\nlet licorice = function () {\n    stickball()\n    view.ao = 0;\n    view.spf = 0;\n    view.outline = 1;\n    view.bonds = true;\n}\n\nlet updateModel = function () {\n    Streamlit.setComponentValue({\n        'bonds': view.bonds,\n        'atomScale': view.atomScale,\n        'relativeAtomScale': view.relativeAtomScale,\n        'bondScale': view.bondScale,\n        'brightness': view.brightness,\n        'outline': view.outline,\n        'spf': view.spf,\n        'bondShade': view.bondShade,\n        'atomShade': view.atomShade,\n        'dofStrength': view.dofStrength,\n        'dofPosition': view.dofPosition,\n        'ao': view.ao,\n        'aoRes': view.aoRes\n    })\n}\n\nlet loadStructure = function (tdata: string) {\n    system = undefined;\n    var data = xyz(tdata)[0];\n    if (data) {\n        system = speckSystem.new();\n        for (var i = 0; i < data.length; i++) {\n            var a = data[i];\n            var x = a.position[0];\n            var y = a.position[1];\n            var z = a.position[2];\n            speckSystem.addAtom(system, a.symbol, x, y, z);\n        }\n        center();\n    }\n}\n\n\nlet center = function () {\n    if (system) {\n        speckSystem.center(system);\n        speckSystem.calculateBonds(system, view);\n        renderer.setSystem(system, view);\n        speckView.center(view, system);\n        needReset = true;\n    }\n}\n\nlet topview = function () {\n    if (system) {\n        speckView.rotateX(view, Math.PI / 2);\n        center();\n    }\n}\n\nlet frontview = function () {\n    if (system) {\n        speckView.rotateX(view, 0);\n        center();\n    }\n}\n\nlet rightview = function () {\n    if (system) {\n        speckView.rotateY(view, -Math.PI / 2);\n        center();\n    }\n}\n\nlet xyz = function (data: string) {\n    var lines = data.split('\\n');\n    var natoms = parseInt(lines[0]);\n    var nframes = Math.floor(lines.length / (natoms + 2));\n    var trajectory = []\n    for (var i = 0; i < nframes; i++) {\n        var atoms = [];\n        type ATOM = {\n            [key: string]: any;\n        };\n        for (var j = 0; j < natoms; j++) {\n            var line = lines[i * (natoms + 2) + j + 2].split(/\\s+/);\n            var atom: ATOM = {};\n            var k = 0;\n            while (line[k] === \"\") k++;\n            atom.symbol = line[k++];\n            atom.position = [parseFloat(line[k++]), parseFloat(line[k++]), parseFloat(line[k++])];\n            atoms.push(atom);\n        }\n        trajectory.push(atoms);\n    }\n    return trajectory;\n}\n\n\nlet reflow = function () {\n    var ww = document.body.clientWidth;\n    var wh = document.body.clientHeight;\n    if (ww === 0)\n        ww = view.resolution.x;\n    if (wh === 0)\n        wh = view.resolution.y;\n    if (view.resolution.x === ww && view.resolution.y === wh)\n        return;\n    container.style.height = wh + \"px\";\n    container.style.width = ww + \"px\";\n    container.style.left = 0 + \"px\";\n    container.style.top = 0 + \"px\";\n    view.resolution.x = ww;\n    view.resolution.y = wh;\n    renderer = new speckRenderer(canvas, view.resolution, view.aoRes);\n}\n\nlet loop = function () {\n    if (needReset) {\n        renderer.reset();\n        needReset = false;\n    }\n    renderer.render(view);\n    requestAnimationFrame(function () { loop() });\n}\n\n/**\n * The component's render function. This will be called immediately after\n * the component is initially loaded, and then again every time the\n * component gets new data from Python.\n */\nfunction onRender(event: Event): void {\n    // Get the RenderData from the event\n    const data = (event as CustomEvent<RenderData>).detail\n    console.log(data.args);\n    document.body.style.width = data.args[\"width\"]\n    document.body.style.height = data.args[\"height\"]\n    view.bonds = data.args['bonds'];\n    view.atomScale = data.args['atomScale'];\n    view.relativeAtomScale = data.args['relativeAtomScale'];\n    view.bondScale = data.args['bondScale'];\n    view.brightness = data.args['brightness'];\n    view.outline = data.args['outline'];\n    view.spf = data.args['spf'];\n    view.bondShade = data.args['bondShade'];\n    view.atomShade = data.args['atomShade'];\n    view.dofStrength = data.args['dofStrength'];\n    view.dofPosition = data.args['dofPosition'];\n    view.ao = data.args['ao'];\n    view.aoRes = data.args['aoRes'];\n    reflow()\n    loop();\n    loadStructure(data.args[\"data\"]);\n    // We tell Streamlit to update our frameHeight after each render event, in\n    // case it has changed. (This isn't strictly necessary for the example\n    // because our height stays fixed, but this is a low-cost function, so\n    // there's no harm in doing it redundantly.)\n    Streamlit.setFrameHeight()\n}\n\n// Attach our `onRender` handler to Streamlit's render event.\nStreamlit.events.addEventListener(Streamlit.RENDER_EVENT, onRender)\n\n// Tell Streamlit we're ready to start receiving data. We won't get our\n// first RENDER_EVENT until we call this function.\nStreamlit.setComponentReady()\n\n// Finally, tell Streamlit to update our initial height. We omit the\n// `height` parameter here to have it default to our scrollHeight.\nStreamlit.setFrameHeight()\n\n","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/view.js",["59","60","61","62","63","64","65","66","67","68","69","70"],"\"use strict\";\n\nvar _ = require('lodash');\nvar glm = require(\"./gl-matrix\");\nvar elements = require(\"./elements\");\nvar consts = require(\"./const\");\n\nfunction clamp(min, max, value) {\n    return Math.min(max, Math.max(min, value));\n}\n\n\nvar newView = module.exports.new = function() {\n    return {\n        aspect: 1.0,\n        zoom: 0.125,\n        translation: {\n            x: 0.0,\n            y: 0.0\n        },\n        atomScale: 0.6,\n        relativeAtomScale: 1.0,\n        bondScale: 0.5,\n        rotation: glm.mat4.create(),\n        ao: 0.75,\n        aoRes: 256,\n        brightness: 0.5,\n        outline: 0.0,\n        spf: 32,\n        bonds: false,\n        bondThreshold: 1.2,\n        bondShade: 0.5,\n        atomShade: 0.5,\n        resolution: {x:768,y:768},\n        dofStrength: 0.0,\n        dofPosition: 0.5,\n        fxaa: 1,\n        elements : _.cloneDeep(elements)\n    };\n};\n\n\nvar center = module.exports.center = function(v, system) {\n    var maxX = -Infinity;\n    var minX = Infinity;\n    var maxY = -Infinity;\n    var minY = Infinity;\n    for(var i = 0; i < system.atoms.length; i++) {\n        var a = system.atoms[i];\n        var r = v.elements[a.symbol].radius;\n        r = 2.5 * v.atomScale * (1 + (r - 1) * v.relativeAtomScale);\n        var p = glm.vec4.fromValues(a.x, a.y, a.z, 0);\n        glm.vec4.transformMat4(p, p, v.rotation);\n        maxX = Math.max(maxX, p[0] + r);\n        minX = Math.min(minX, p[0] - r);\n        maxY = Math.max(maxY, p[1] + r);\n        minY = Math.min(minY, p[1] - r);\n    }\n    var cx = minX + (maxX - minX) / 2.0;\n    var cy = minY + (maxY - minY) / 2.0;\n    let mres = Math.max(v.resolution.x,v.resolution.y)\n    //cx += (maxX - minX) * (1-v.resolution.x/mres);\n    //cy += (maxY - minY) * (1-v.resolution.y/mres);\n    cx += (maxX - minX) * (mres/v.resolution.x - 1)/2;\n    cy += (maxY - minY) * (mres/v.resolution.y - 1)/2;\n    v.translation.x = cx;\n    v.translation.y = cy;\n    var scale = Math.max((maxX - minX)*(mres/v.resolution.x), (maxY - minY)*(mres/v.resolution.y));\n    v.zoom = 1/(scale * 1.01);\n};\n\n\nvar override = module.exports.override = function(v, data) {\n    for (var key in data) {\n        v[key] = data[key];\n    }\n    resolve(v);\n};\n\n\nvar clone = module.exports.clone = function(v) {\n    return deserialize(serialize(v));\n};\n\n\nvar serialize = module.exports.serialize = function(v) {\n    return JSON.stringify(v);\n};\n\n\nvar deserialize = module.exports.deserialize = function(v) {\n    v = JSON.parse(v);\n    v.rotation = glm.mat4.clone(v.rotation);\n    return v;\n};\n\n\nvar resolve = module.exports.resolve = function(v) {\n    v.dofStrength = clamp(0, 1, v.dofStrength);\n    v.dofPosition = clamp(0, 1, v.dofPosition);\n    v.zoom = clamp(0.001, 2.0, v.zoom);\n    v.atomScale = clamp(0, 1, v.atomScale);\n    v.relativeAtomScale = clamp(0, 1, v.relativeAtomScale);\n    v.bondScale = clamp(0, 1, v.bondScale);\n    v.bondShade = clamp(0, 1, v.bondShade);\n    v.atomShade = clamp(0, 1, v.atomShade);\n    v.ao = clamp(0, 1, v.ao);\n    v.brightness = clamp(0, 1, v.brightness);\n    v.outline = clamp(0, 1, v.outline);\n};\n\n\nvar translate = module.exports.translate = function(v, dx, dy) {\n    v.translation.x -= dx/(v.resolution.x * v.zoom);\n    v.translation.y += dy/(v.resolution.y * v.zoom);\n    resolve(v);\n};\n\n\nvar rotate = module.exports.rotate = function(v, dx, dy) {\n    var m = glm.mat4.create();\n    glm.mat4.rotateY(m, m, dx * 0.005);\n    glm.mat4.rotateX(m, m, dy * 0.005);\n    glm.mat4.multiply(v.rotation, m, v.rotation);\n    const ao = v.ao;\n    v.ao = 0;\n    resolve(v);\n    v.ao = ao;\n};\n\nvar rotateX = module.exports.rotateX = function(v, dx) {\n    var m = glm.mat4.create();\n    glm.mat4.rotateX(m, m, dx);\n    v.rotation = m;\n    //glm.mat4.multiply(v.rotation, m, v.rotation);\n    const ao = v.ao;\n    v.ao = 0;\n    resolve(v);\n    v.ao = ao;\n};\n\nvar rotateY = module.exports.rotateY = function(v, dy) {\n    var m = glm.mat4.create();\n    glm.mat4.rotateY(m, m, dy);\n    v.rotation = m;\n    //glm.mat4.multiply(v.rotation, m, v.rotation);\n    const ao = v.ao;\n    v.ao = 0;\n    resolve(v);\n    v.ao = ao;\n};\n\nvar rotateZ = module.exports.rotateZ = function(v, dz) {\n    var m = glm.mat4.create();\n    glm.mat4.rotateZ(m, m, dz);\n    v.rotation = m;\n    //glm.mat4.multiply(v.rotation, m, v.rotation);\n    const ao = v.ao;\n    v.ao = 0;\n    resolve(v);\n    v.ao = ao;\n};\n\n\nvar getRect = module.exports.getRect = function(v) {\n    var width = 1.0/v.zoom;\n    var height = width/v.aspect;\n    var bottom = -height/2 + v.translation.y;\n    var top = height/2 + v.translation.y;\n    var left = -width/2 + v.translation.x;\n    var right = width/2 + v.translation.x;\n    return {\n        bottom: bottom,\n        top: top,\n        left: left,\n        right: right\n    };\n};\n\n\nvar getBondRadius = module.exports.getBondRadius = function(v) {\n    return v.bondScale * v.atomScale *\n        (1 + (consts.MIN_ATOM_RADIUS - 1) * v.relativeAtomScale);\n};\n","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/colors.js",[],"/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/interactions.js",["71","72","73"],"\"use strict\";\n\nvar speckView = require(\"./view.js\");\n\nmodule.exports = function(args) {\n    if(arguments.length > 1) {\n        throw \"Error: The Speck Interactions module has changed!\";\n    }\n    else if((arguments.length === 0) || (typeof args !== \"object\")) {\n        throw \"Error: Arguments not provided to interactions\";\n    }\n\n    var scrollZoom = args.scrollZoom === undefined ? true : args.scrollZoom;\n    var container = args.container;\n\n    var getRotation = args.getRotation;\n    var setRotation = args.setRotation;\n\n    var getTranslation = args.getTranslation;\n    var setTranslation = args.setTranslation;\n\n    var getZoom = args.getZoom;\n    var setZoom = args.setZoom;\n\n    var refreshView = args.refreshView;\n\n    var interactions = {\n        buttonDown: false,\n        shiftDown: false,\n        lastX: 0.0,\n        lastY: 0.0\n    };\n\n    function mousedownFn(e) {\n        if(e.button === 0) {\n            interactions = {\n                buttonDown: true,\n                shiftDown: interactions.shiftDown,\n                lastX: e.clientX,\n                lastY: e.clientY\n            };\n        }\n    }\n    container.addEventListener(\"mousedown\", mousedownFn);\n\n    function mouseupFn(e) {\n        if(e.button === 0) {\n            if(!interactions.buttonDown) {\n                return;\n            }\n\n            interactions.buttonDown = false;\n        }\n    }\n    window.addEventListener(\"mouseup\", mouseupFn);\n\n    function keychangeFn(e) {\n        interactions.shiftDown = e.shiftKey;\n    }\n    window.addEventListener(\"keydown\", keychangeFn);\n    window.addEventListener(\"keyup\", keychangeFn);\n\n    function mousemoveFn(e) {\n        if(!interactions.buttonDown || (e.buttons === 0)){\n            return;\n        }\n\n        // prevents interaction with other page elements while dragging\n        e.preventDefault();\n\n        var dx = e.clientX - interactions.lastX;\n        var dy = e.clientY - interactions.lastY;\n        if(dx === 0 && dy === 0) {\n            return;\n        }\n\n        interactions.lastX = e.clientX;\n        interactions.lastY = e.clientY;\n\n        if(interactions.shiftDown) {\n            var translation = getTranslation();\n            var inverseZoom = 0.001/getZoom();\n            setTranslation({\n                x: translation.x - dx * inverseZoom,\n                y: translation.y + dy * inverseZoom\n            });\n        }\n        else {\n            var viewDummyObj = {\n                rotation: new Float32Array(getRotation())\n            };\n            speckView.rotate(viewDummyObj, dx, dy);\n\n            setRotation(viewDummyObj.rotation);\n        }\n        refreshView();\n    }\n    window.addEventListener(\"mousemove\", mousemoveFn);\n\n    function wheelFn(e) {\n        // prevents the page from scrolling when using scroll wheel inside speck component\n        e.preventDefault();\n\n        setZoom(getZoom() * (e.deltaY < 0 ? 1/0.9 : 0.9));\n        refreshView();\n\n    }\n    if(scrollZoom) {\n        container.addEventListener(\"wheel\", wheelFn);\n    }\n\n    function removeAllEventListeners() {\n        container.removeEventListener(\"mousedown\", mousedownFn);\n        window.removeEventListener(\"mouseup\", mouseupFn);\n        window.removeEventListener(\"keydown\", keychangeFn);\n        window.removeEventListener(\"keyup\", keychangeFn);\n        window.removeEventListener(\"mousemove\", mousemoveFn);\n        container.removeEventListener(\"wheel\", wheelFn);\n    }\n\n    return removeAllEventListeners;\n}\n","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/system.js",["74","75","76","77","78","79","80","81"],"\"use strict\";\n\nvar glm = require(\"./gl-matrix\")\n\nvar elements = require(\"./elements\");\nvar consts = require(\"./const\");\n\nvar newSystem = module.exports.new = function() {\n    return {\n        atoms: [],\n        farAtom: undefined,\n        bonds: []\n    }\n};\n\nvar calculateBonds = module.exports.calculateBonds = function(s, v) {\n    var elems = elements;\n    if (v != undefined)\n        elems = v.elements;\n    var bonds = [];\n    var sorted = s.atoms.slice();\n    sorted.sort(function(a, b) {\n        return a.z - b.z;\n    });\n    for (var i = 0; i < sorted.length; i++) {\n        var a = sorted[i];\n        var j = i + 1;\n        while(j < sorted.length && sorted[j].z < sorted[i].z + 2.5 * 2 * consts.MAX_ATOM_RADIUS) {\n            var b = sorted[j];\n            var l = glm.vec3.fromValues(a.x, a.y, a.z);\n            var m = glm.vec3.fromValues(b.x, b.y, b.z);\n            var d = glm.vec3.distance(l, m);\n            var ea = elems[a.symbol];\n            var eb = elems[b.symbol];\n            if (d < 2.5*(ea.radius+eb.radius)) {\n                bonds.push({\n                    posA: {\n                        x: a.x,\n                        y: a.y,\n                        z: a.z\n                    },\n                    posB: {\n                        x: b.x,\n                        y: b.y,\n                        z: b.z\n                    },\n                    radA: ea.radius,\n                    radB: eb.radius,\n                    colA: {\n                        r: ea.color[0],\n                        g: ea.color[1],\n                        b: ea.color[2]\n                    },\n                    colB: {\n                        r: eb.color[0],\n                        g: eb.color[1],\n                        b: eb.color[2]\n                    },\n                    cutoff: d/(ea.radius+eb.radius)\n                });\n            }\n            j++;\n        }\n    }\n    bonds.sort(function(a, b) {\n        return a.cutoff - b.cutoff;\n    });\n    s.bonds = bonds;\n}\n\n\nvar addAtom = module.exports.addAtom = function(s, symbol, x, y, z) {\n    s.atoms.push({\n        symbol: symbol,\n        x: x,\n        y: y,\n        z: z,\n    });\n};\n\nvar getCentroid = module.exports.getCentroid = function(s) {\n    var xsum = 0;\n    var ysum = 0;\n    var zsum = 0;\n    for (var i = 0; i < s.atoms.length; i++) {\n        xsum += s.atoms[i].x;\n        ysum += s.atoms[i].y;\n        zsum += s.atoms[i].z;\n    }\n    return {\n        x: xsum/s.atoms.length,\n        y: ysum/s.atoms.length,\n        z: zsum/s.atoms.length\n    };\n};\n\nvar center = module.exports.center = function(s) {\n    var shift = getCentroid(s);\n    for (var i = 0; i < s.atoms.length; i++) {\n        var atom = s.atoms[i];\n        atom.x -= shift.x;\n        atom.y -= shift.y;\n        atom.z -= shift.z;\n    }\n}\n\nvar getFarAtom = module.exports.getFarAtom = function(s, v) {\n    if (s.farAtom !== undefined) {\n        return s.farAtom;\n    }\n    var elems = elements;\n    if (v != undefined)\n        elems = v.elements;\n\n    s.farAtom = s.atoms[0];\n    var maxd = 0.0;\n    for (var i = 0; i < s.atoms.length; i++) {\n        var atom = s.atoms[i];\n        var r = elems[atom.symbol].radius;\n        var rd = Math.sqrt(r*r + r*r + r*r) * 2.5;\n        var d = Math.sqrt(atom.x*atom.x + atom.y*atom.y + atom.z*atom.z) + rd;\n        if (d > maxd) {\n            maxd = d;\n            s.farAtom = atom;\n        }\n    }\n    return s.farAtom;\n}\n\nvar getRadius = module.exports.getRadius = function(s, v) {\n    var atom = getFarAtom(s, v);\n    var r = consts.MAX_ATOM_RADIUS;\n    var rd = Math.sqrt(r*r + r*r + r*r) * 2.5;\n    return Math.sqrt(atom.x*atom.x + atom.y*atom.y + atom.z*atom.z) + rd;\n}\n","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/renderer.js",["82","83","84","85","86","87","88","89","90","91","92","93"],"\"use strict\";\n\nvar glm = require('./gl-matrix');\nvar webgl = require('./webgl.js');\nvar cube = require(\"./cube\");\nvar elements = require(\"./elements\");\nvar View = require(\"./view\");\nvar System = require(\"./system\");\nvar shaders = require(\"./shaders\");\n\nmodule.exports = function (canvas, resolution, aoResolution) {\n        let m_resolution = Math.max(resolution.x, resolution.y)\n        var self = this;\n\n        var range,\n            samples,\n            system;\n\n        var gl,\n            canvas;\n\n        var rAtoms = null,\n            rBonds = null,\n            rDispQuad = null,\n            rAccumulator = null,\n            rAO = null,\n            rDOF = null,\n            rFXAA = null;\n\n        var tSceneColor, tSceneNormal, tSceneDepth,\n            tRandRotDepth, tRandRotColor,\n            tAccumulator, tAccumulatorOut,\n            tFXAA, tFXAAOut,\n            tDOF,\n            tAO;\n\n        var fbSceneColor, fbSceneNormal,\n            fbRandRot,\n            fbAccumulator,\n            fbFXAA,\n            fbDOF,\n            fbAO;\n\n        var progAtoms,\n            progBonds,\n            progAccumulator,\n            progAO,\n            progFXAA,\n            progDOF,\n            progDisplayQuad;\n\n        var ext;\n\n        var sampleCount = 0,\n            colorRendered = false,\n            normalRendered = false;\n\n        self.getAOProgress = function() {\n            return sampleCount/1024;\n        }\n\n        self.initialize = function() {\n\n            // Initialize canvas/gl.\n            canvas.width = resolution.x;\n            canvas.height = resolution.y;\n            gl = canvas.getContext('webgl');\n            gl.enable(gl.DEPTH_TEST);\n            gl.enable(gl.CULL_FACE);\n            gl.clearColor(0,0,0,0);\n            gl.clearDepth(1);\n            gl.viewport(0,0,m_resolution,m_resolution);\n\n            window.gl = gl; //debug\n\n            ext = webgl.getExtensions(gl, [\n                \"EXT_frag_depth\",\n                \"WEBGL_depth_texture\",\n            ]);\n\n            self.createTextures();\n\n            // Initialize shaders.\n            progAtoms = loadProgram(gl, shaders.shaders['atom']);\n            progBonds = loadProgram(gl, shaders.shaders['bond']);\n            progDisplayQuad = loadProgram(gl, shaders.shaders['textured-quad']);\n            progAccumulator = loadProgram(gl, shaders.shaders['accumulator']);\n            progAO = loadProgram(gl, shaders.shaders['ao']);\n            progFXAA = loadProgram(gl, shaders.shaders['fxaa']);\n            progDOF = loadProgram(gl, shaders.shaders['dof']);\n\n            var position = [\n                -1, -1, 0,\n                 1, -1, 0,\n                 1,  1, 0,\n                -1, -1, 0,\n                 1,  1, 0,\n                -1,  1, 0\n            ];\n\n            // Initialize geometry.\n            var attribs = webgl.buildAttribs(gl, {aPosition: 3});\n            attribs.aPosition.buffer.set(new Float32Array(position));\n            var count = position.length / 9;\n\n            rDispQuad = new webgl.Renderable(gl, progDisplayQuad, attribs, count);\n            rAccumulator = new webgl.Renderable(gl, progAccumulator, attribs, count);\n            rAO = new webgl.Renderable(gl, progAO, attribs, count);\n            rFXAA = new webgl.Renderable(gl, progFXAA, attribs, count);\n            rDOF = new webgl.Renderable(gl, progDOF, attribs, count);\n\n            samples = 0;\n\n        }\n\n        self.createTextures = function() {\n            // fbRandRot\n            tRandRotColor = new webgl.Texture(gl, 0, null, aoResolution, aoResolution);\n\n            tRandRotDepth = new webgl.Texture(gl, 1, null, aoResolution, aoResolution, {\n                internalFormat: gl.DEPTH_COMPONENT,\n                format: gl.DEPTH_COMPONENT,\n                type: gl.UNSIGNED_SHORT\n            });\n\n            fbRandRot = new webgl.Framebuffer(gl, [tRandRotColor], tRandRotDepth);\n\n            // fbScene\n            tSceneColor = new webgl.Texture(gl, 2, null, m_resolution, m_resolution);\n\n            tSceneNormal = new webgl.Texture(gl, 3, null, m_resolution, m_resolution);\n\n            tSceneDepth = new webgl.Texture(gl, 4, null, m_resolution, m_resolution, {\n                internalFormat: gl.DEPTH_COMPONENT,\n                format: gl.DEPTH_COMPONENT,\n                type: gl.UNSIGNED_SHORT\n            });\n\n            fbSceneColor = new webgl.Framebuffer(gl, [tSceneColor], tSceneDepth);\n\n            fbSceneNormal = new webgl.Framebuffer(gl, [tSceneNormal], tSceneDepth);\n\n            // fbAccumulator\n            tAccumulator = new webgl.Texture(gl, 5, null, m_resolution, m_resolution);\n            tAccumulatorOut = new webgl.Texture(gl, 6, null, m_resolution, m_resolution);\n            fbAccumulator = new webgl.Framebuffer(gl, [tAccumulatorOut]);\n\n            // fbAO\n            tAO = new webgl.Texture(gl, 7, null, m_resolution, m_resolution);\n            fbAO = new webgl.Framebuffer(gl, [tAO]);\n\n            // fbFXAA\n            tFXAA = new webgl.Texture(gl, 8, null, m_resolution, m_resolution);\n            tFXAAOut = new webgl.Texture(gl, 9, null, m_resolution, m_resolution);\n            fbFXAA = new webgl.Framebuffer(gl, [tFXAAOut]);\n\n            // fbDOF\n            tDOF = new webgl.Texture(gl, 10, null, m_resolution, m_resolution);\n            fbDOF = new webgl.Framebuffer(gl, [tDOF]);\n        }\n\n        self.setResolution = function(res, aoRes) {\n            aoResolution = aoRes;\n            resolution = res;\n            canvas.width = resolution.x;\n            canvas.height = resolution.y;\n            gl.viewport(0,0,m_resolution,m_resolution);\n            self.createTextures();\n        }\n\n\n        self.setSystem = function(newSystem, view) {\n\n            system = newSystem;\n\n            function make36(arr) {\n                var out = [];\n                for (var i = 0; i < 36; i++) {\n                    out.push.apply(out, arr);\n                }\n                return out;\n            }\n\n            // Atoms\n            var attribs = webgl.buildAttribs(gl, {\n                aImposter: 3, aPosition: 3, aRadius: 1, aColor: 3\n            });\n\n            var imposter = [];\n            var position = [];\n            var radius = [];\n            var color = [];\n\n            for (var i = 0; i < system.atoms.length; i++) {\n                imposter.push.apply(imposter, cube.position);\n                var a = system.atoms[i];\n                position.push.apply(position, make36([a.x, a.y, a.z]));\n                radius.push.apply(radius, make36([view.elements[a.symbol].radius]));\n                var c = view.elements[a.symbol].color;\n                color.push.apply(color, make36([c[0], c[1], c[2]]));\n            }\n\n            attribs.aImposter.buffer.set(new Float32Array(imposter));\n            attribs.aPosition.buffer.set(new Float32Array(position));\n            attribs.aRadius.buffer.set(new Float32Array(radius));\n            attribs.aColor.buffer.set(new Float32Array(color));\n\n            var count = imposter.length / 9;\n\n            rAtoms = new webgl.Renderable(gl, progAtoms, attribs, count);\n\n            // Bonds\n\n            if (view.bonds) {\n\n                rBonds = null;\n\n                if (system.bonds.length > 0) {\n\n                    var attribs = webgl.buildAttribs(gl, {\n                        aImposter: 3,\n                        aPosA: 3,\n                        aPosB: 3,\n                        aRadA: 1,\n                        aRadB: 1,\n                        aColA: 3,\n                        aColB: 3\n                    })\n\n                    var imposter = [];\n                    var posa = [];\n                    var posb = [];\n                    var rada = [];\n                    var radb = [];\n                    var cola = [];\n                    var colb = [];\n\n                    for (var i = 0; i < system.bonds.length; i++) {\n                        var b = system.bonds[i];\n                        if (b.cutoff > view.bondThreshold) break;\n                        imposter.push.apply(imposter, cube.position);\n                        posa.push.apply(posa, make36([b.posA.x, b.posA.y, b.posA.z]));\n                        posb.push.apply(posb, make36([b.posB.x, b.posB.y, b.posB.z]));\n                        rada.push.apply(rada, make36([b.radA]));\n                        radb.push.apply(radb, make36([b.radB]));\n                        cola.push.apply(cola, make36([b.colA.r, b.colA.g, b.colA.b]));\n                        colb.push.apply(colb, make36([b.colB.r, b.colB.g, b.colB.b]));\n                    }\n\n                    attribs.aImposter.buffer.set(new Float32Array(imposter));\n                    attribs.aPosA.buffer.set(new Float32Array(posa));\n                    attribs.aPosB.buffer.set(new Float32Array(posb));\n                    attribs.aRadA.buffer.set(new Float32Array(rada));\n                    attribs.aRadB.buffer.set(new Float32Array(radb));\n                    attribs.aColA.buffer.set(new Float32Array(cola));\n                    attribs.aColB.buffer.set(new Float32Array(colb));\n\n                    var count = imposter.length / 9;\n\n                    rBonds = new webgl.Renderable(gl, progBonds, attribs, count);\n\n                }\n\n            }\n\n        }\n\n        self.reset = function() {\n            sampleCount = 0;\n            colorRendered = false;\n            normalRendered = false;\n            tAccumulator.reset();\n            tAccumulatorOut.reset();\n        }\n\n        self.render = function(view) {\n            if (system === undefined) {\n                return;\n            }\n            if (rAtoms == null) {\n                return;\n            }\n\n            range = System.getRadius(system) * 2.0;\n\n            if (!colorRendered) {\n                color(view);\n            } else if (!normalRendered){\n                normal(view);\n            } else {\n                for (var i = 0; i < view.spf; i++) {\n                    if (sampleCount > 1024) {\n                        break;\n                    }\n                    sample(view);\n                    sampleCount++;\n                }\n            }\n            display(view);\n        }\n\n        function color(view) {\n            colorRendered = true;\n            gl.viewport(0, 0, m_resolution, m_resolution);\n            fbSceneColor.bind();\n            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n            var rect = View.getRect(view);\n            var projection = glm.mat4.create();\n            glm.mat4.ortho(projection, rect.left, rect.right, rect.bottom, rect.top, 0, range);\n            var viewMat = glm.mat4.create();\n            glm.mat4.lookAt(viewMat, [0, 0, 0], [0, 0, -1], [0, 1, 0]);\n            var model = glm.mat4.create();\n            glm.mat4.translate(model, model, [0, 0, -range/2]);\n            glm.mat4.multiply(model, model, view.rotation);\n            progAtoms.setUniform(\"uProjection\", \"Matrix4fv\", false, projection);\n            progAtoms.setUniform(\"uView\", \"Matrix4fv\", false, viewMat);\n            progAtoms.setUniform(\"uModel\", \"Matrix4fv\", false, model);\n            progAtoms.setUniform(\"uBottomLeft\", \"2fv\", [rect.left, rect.bottom]);\n            progAtoms.setUniform(\"uTopRight\", \"2fv\", [rect.right, rect.top]);\n            progAtoms.setUniform(\"uAtomScale\", \"1f\", 2.5 * view.atomScale);\n            progAtoms.setUniform(\"uRelativeAtomScale\", \"1f\", view.relativeAtomScale);\n            progAtoms.setUniform(\"uRes\", \"1f\", m_resolution);\n            progAtoms.setUniform(\"uDepth\", \"1f\", range);\n            progAtoms.setUniform(\"uMode\", \"1i\", 0);\n            progAtoms.setUniform(\"uAtomShade\", \"1f\", view.atomShade);\n            rAtoms.render();\n\n            if (view.bonds && rBonds != null) {\n                fbSceneColor.bind();\n                progBonds.setUniform(\"uProjection\", \"Matrix4fv\", false, projection);\n                progBonds.setUniform(\"uView\", \"Matrix4fv\", false, viewMat);\n                progBonds.setUniform(\"uModel\", \"Matrix4fv\", false, model);\n                progBonds.setUniform(\"uRotation\", \"Matrix4fv\", false, view.rotation);\n                progBonds.setUniform(\"uDepth\", \"1f\", range);\n                progBonds.setUniform(\"uBottomLeft\", \"2fv\", [rect.left, rect.bottom]);\n                progBonds.setUniform(\"uTopRight\", \"2fv\", [rect.right, rect.top]);\n                progBonds.setUniform(\"uRes\", \"1f\", m_resolution);\n                progBonds.setUniform(\"uBondRadius\", \"1f\", 2.5 * View.getBondRadius(view));\n                progBonds.setUniform(\"uBondShade\", \"1f\", view.bondShade);\n                progBonds.setUniform(\"uAtomScale\", \"1f\", 2.5 * view.atomScale);\n                progBonds.setUniform(\"uRelativeAtomScale\", \"1f\", view.relativeAtomScale);\n                progBonds.setUniform(\"uMode\", \"1i\", 0);\n                rBonds.render();\n            }\n        }\n\n\n        function normal(view) {\n            normalRendered = true;\n            gl.viewport(0, 0, m_resolution, m_resolution);\n            fbSceneNormal.bind();\n            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n            var rect = View.getRect(view);\n            var projection = glm.mat4.create();\n            glm.mat4.ortho(projection, rect.left, rect.right, rect.bottom, rect.top, 0, range);\n            var viewMat = glm.mat4.create();\n            glm.mat4.lookAt(viewMat, [0, 0, 0], [0, 0, -1], [0, 1, 0]);\n            var model = glm.mat4.create();\n            glm.mat4.translate(model, model, [0, 0, -range/2]);\n            glm.mat4.multiply(model, model, view.rotation);\n            progAtoms.setUniform(\"uProjection\", \"Matrix4fv\", false, projection);\n            progAtoms.setUniform(\"uView\", \"Matrix4fv\", false, viewMat);\n            progAtoms.setUniform(\"uModel\", \"Matrix4fv\", false, model);\n            progAtoms.setUniform(\"uBottomLeft\", \"2fv\", [rect.left, rect.bottom]);\n            progAtoms.setUniform(\"uTopRight\", \"2fv\", [rect.right, rect.top]);\n            progAtoms.setUniform(\"uAtomScale\", \"1f\", 2.5 * view.atomScale);\n            progAtoms.setUniform(\"uRelativeAtomScale\", \"1f\", view.relativeAtomScale);\n            progAtoms.setUniform(\"uRes\", \"1f\", m_resolution);\n            progAtoms.setUniform(\"uDepth\", \"1f\", range);\n            progAtoms.setUniform(\"uMode\", \"1i\", 1);\n            progAtoms.setUniform(\"uAtomShade\", \"1f\", view.atomShade);\n            rAtoms.render();\n\n            if (view.bonds && rBonds != null) {\n                fbSceneNormal.bind();\n                progBonds.setUniform(\"uProjection\", \"Matrix4fv\", false, projection);\n                progBonds.setUniform(\"uView\", \"Matrix4fv\", false, viewMat);\n                progBonds.setUniform(\"uModel\", \"Matrix4fv\", false, model);\n                progBonds.setUniform(\"uRotation\", \"Matrix4fv\", false, view.rotation);\n                progBonds.setUniform(\"uDepth\", \"1f\", range);\n                progBonds.setUniform(\"uBottomLeft\", \"2fv\", [rect.left, rect.bottom]);\n                progBonds.setUniform(\"uTopRight\", \"2fv\", [rect.right, rect.top]);\n                progBonds.setUniform(\"uRes\", \"1f\", m_resolution);\n                progBonds.setUniform(\"uBondRadius\", \"1f\", 2.5 * View.getBondRadius(view));\n                progBonds.setUniform(\"uBondShade\", \"1f\", view.bondShade);\n                progBonds.setUniform(\"uAtomScale\", \"1f\", 2.5 * view.atomScale);\n                progBonds.setUniform(\"uRelativeAtomScale\", \"1f\", view.relativeAtomScale);\n                progBonds.setUniform(\"uMode\", \"1i\", 1);\n                rBonds.render();\n            }\n        }\n\n\n        function sample(view) {\n            gl.viewport(0, 0, aoResolution, aoResolution);\n            var v = View.clone(view);\n            v.zoom = 1/range;\n            v.translation.x = 0;\n            v.translation.y = 0;\n            var rot = glm.mat4.create();\n            for (var i = 0; i < 3; i++) {\n                var axis = glm.vec3.random(glm.vec3.create(), 1.0);\n                glm.mat4.rotate(rot, rot, Math.random() * 10, axis);\n            }\n            v.rotation = glm.mat4.multiply(glm.mat4.create(), rot, v.rotation);\n            fbRandRot.bind()\n            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n            var rect = View.getRect(v);\n            var projection = glm.mat4.create();\n            glm.mat4.ortho(projection, rect.left, rect.right, rect.bottom, rect.top, 0, range);\n            var viewMat = glm.mat4.create();\n            glm.mat4.lookAt(viewMat, [0, 0, 0], [0, 0, -1], [0, 1, 0]);\n            var model = glm.mat4.create();\n            glm.mat4.translate(model, model, [0, 0, -range/2]);\n            glm.mat4.multiply(model, model, v.rotation);\n            progAtoms.setUniform(\"uProjection\", \"Matrix4fv\", false, projection);\n            progAtoms.setUniform(\"uView\", \"Matrix4fv\", false, viewMat);\n            progAtoms.setUniform(\"uModel\", \"Matrix4fv\", false, model);\n            progAtoms.setUniform(\"uBottomLeft\", \"2fv\", [rect.left, rect.bottom]);\n            progAtoms.setUniform(\"uTopRight\", \"2fv\", [rect.right, rect.top]);\n            progAtoms.setUniform(\"uAtomScale\", \"1f\", 2.5 * v.atomScale);\n            progAtoms.setUniform(\"uRelativeAtomScale\", \"1f\", view.relativeAtomScale);\n            progAtoms.setUniform(\"uRes\", \"1f\", aoResolution);\n            progAtoms.setUniform(\"uDepth\", \"1f\", range);\n            progAtoms.setUniform(\"uMode\", \"1i\", 0);\n            progAtoms.setUniform(\"uAtomShade\", \"1f\", view.atomShade);\n            rAtoms.render();\n\n            if (view.bonds && rBonds != null) {\n                progBonds.setUniform(\"uProjection\", \"Matrix4fv\", false, projection);\n                progBonds.setUniform(\"uView\", \"Matrix4fv\", false, viewMat);\n                progBonds.setUniform(\"uModel\", \"Matrix4fv\", false, model);\n                progBonds.setUniform(\"uRotation\", \"Matrix4fv\", false, v.rotation);\n                progBonds.setUniform(\"uDepth\", \"1f\", range);\n                progBonds.setUniform(\"uBottomLeft\", \"2fv\", [rect.left, rect.bottom]);\n                progBonds.setUniform(\"uTopRight\", \"2fv\", [rect.right, rect.top]);\n                progBonds.setUniform(\"uRes\", \"1f\", aoResolution);\n                progBonds.setUniform(\"uBondRadius\", \"1f\", 2.5 * View.getBondRadius(view));\n                progBonds.setUniform(\"uBondShade\", \"1f\", view.bondShade);\n                progBonds.setUniform(\"uAtomScale\", \"1f\", 2.5 * view.atomScale);\n                progBonds.setUniform(\"uRelativeAtomScale\", \"1f\", view.relativeAtomScale);\n                progBonds.setUniform(\"uMode\", \"1i\", 0);\n                rBonds.render();\n            }\n\n            gl.viewport(0, 0, m_resolution, m_resolution);\n            var sceneRect = View.getRect(view);\n            var rotRect = View.getRect(v);\n            var invRot = glm.mat4.invert(glm.mat4.create(), rot);\n            fbAccumulator.bind();\n            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n            progAccumulator.setUniform(\"uSceneDepth\", \"1i\", tSceneDepth.index);\n            progAccumulator.setUniform(\"uSceneNormal\", \"1i\", tSceneNormal.index);\n            progAccumulator.setUniform(\"uRandRotDepth\", \"1i\", tRandRotDepth.index);\n            progAccumulator.setUniform(\"uAccumulator\", \"1i\", tAccumulator.index);\n            progAccumulator.setUniform(\"uSceneBottomLeft\", \"2fv\", [sceneRect.left, sceneRect.bottom]);\n            progAccumulator.setUniform(\"uSceneTopRight\", \"2fv\", [sceneRect.right, sceneRect.top]);\n            progAccumulator.setUniform(\"uRotBottomLeft\", \"2fv\", [rotRect.left, rotRect.bottom]);\n            progAccumulator.setUniform(\"uRotTopRight\", \"2fv\", [rotRect.right, rotRect.top]);\n            progAccumulator.setUniform(\"uRes\", \"1f\", m_resolution);\n            progAccumulator.setUniform(\"uDepth\", \"1f\", range);\n            progAccumulator.setUniform(\"uRot\", \"Matrix4fv\", false, rot);\n            progAccumulator.setUniform(\"uInvRot\", \"Matrix4fv\", false, invRot);\n            progAccumulator.setUniform(\"uSampleCount\", \"1i\", sampleCount);\n            rAccumulator.render();\n            tAccumulator.activate();\n            tAccumulator.bind();\n            gl.copyTexImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 0, 0, m_resolution, m_resolution, 0);\n        }\n\n        function display(view) {\n            gl.viewport(0, 0, m_resolution, m_resolution);\n            if (view.fxaa > 0 || view.dofStrength > 0) {\n                fbAO.bind();\n            } else {\n                gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n            }\n            gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n            progAO.setUniform(\"uSceneColor\", \"1i\", tSceneColor.index);\n            progAO.setUniform(\"uSceneDepth\", \"1i\", tSceneDepth.index);\n            progAO.setUniform(\"uAccumulatorOut\", \"1i\", tAccumulatorOut.index);\n            progAO.setUniform(\"uRes\", \"1f\", m_resolution);\n            progAO.setUniform(\"uAO\", \"1f\", 2.0 * view.ao);\n            progAO.setUniform(\"uBrightness\", \"1f\", 2.0 * view.brightness);\n            progAO.setUniform(\"uOutlineStrength\", \"1f\", view.outline);\n            rAO.render();\n\n            if (view.fxaa > 0) {\n                if (view.dofStrength > 0) {\n                    fbFXAA.bind();\n                } else {\n                    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n                }\n                for (var i = 0; i < view.fxaa; i++) {\n                    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n                    if (i == 0) {\n                        progFXAA.setUniform(\"uTexture\", \"1i\", tAO.index);\n                    } else {\n                        progFXAA.setUniform(\"uTexture\", \"1i\", tFXAA.index);\n                    }\n                    progFXAA.setUniform(\"uRes\", \"1f\", m_resolution);\n                    rFXAA.render();\n                    tFXAA.activate();\n                    tFXAA.bind();\n                    gl.copyTexImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 0, 0, m_resolution, m_resolution, 0);\n                }\n            }\n\n            if (view.dofStrength > 0) {\n                gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n                gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n                if (view.fxaa > 0) {\n                    progDOF.setUniform(\"uColor\", \"1i\", tFXAA.index);\n                } else {\n                    progDOF.setUniform(\"uColor\", \"1i\", tAO.index);\n                }\n                progDOF.setUniform(\"uDepth\", \"1i\", tSceneDepth.index);\n                progDOF.setUniform(\"uDOFPosition\", \"1f\", view.dofPosition);\n                progDOF.setUniform(\"uDOFStrength\", \"1f\", view.dofStrength);\n                progDOF.setUniform(\"uRes\", \"1f\", m_resolution);\n                rDOF.render();\n            }\n\n\n            // gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n            // gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n            // progDisplayQuad.setUniform(\"uTexture\", \"1i\", tSceneColor.index);\n            // progDisplayQuad.setUniform(\"uRes\", \"1f\", m_resolution);\n            // rDispQuad.render();\n        }\n\n        self.initialize();\n}\n\n\nfunction loadProgram(gl, src) {\n    src = src.split('// __split__');\n    return new webgl.Program(gl, src[0], src[1]);\n}\n","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/webgl.js",["94","95","96","97","98","99"],"\n//|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nfunction buildAttribs(gl, layout) {\n    var attribs = {};\n    for (var key in layout) {\n        attribs[key] = {\n            buffer: new GLBuffer(gl),\n            size: layout[key]\n        }\n    }\n    return attribs;\n}\n\nmodule.exports.buildAttribs = buildAttribs;\n\n\n//|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nfunction getExtensions(gl, extArray) {\n    var ext = {};\n    for (var i = 0; i < extArray.length; i++) {\n        var e = gl.getExtension(extArray[i]);\n        if (e === null) {\n            throw \"Extension \" + extArray[i] + \" not available.\";\n        }\n        ext[extArray[i]] = e;\n    }\n    return ext;\n};\n\nmodule.exports.getExtensions = getExtensions;\n\n\n//|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nfunction Framebuffer(gl, color, depth, ext) {\n\n    var self = this;\n\n    self.initialize = function() {\n        self.fb = gl.createFramebuffer();\n        self.bind();\n        if (color.length > 1) {\n            var drawBuffers = [];\n            for (var i = 0; i < color.length; i++) {\n                drawBuffers.push(ext[\"COLOR_ATTACHMENT\" + i + \"_WEBGL\"]);\n            }\n            ext.drawBuffersWEBGL(drawBuffers);\n            for (var i = 0; i < color.length; i++) {\n                gl.framebufferTexture2D(gl.FRAMEBUFFER, ext[\"COLOR_ATTACHMENT\" + i + \"_WEBGL\"],\n                    gl.TEXTURE_2D, color[i].texture, 0);\n            }\n        } else {\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, color[0].texture, 0);\n        }\n        if (depth !== undefined) {\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.TEXTURE_2D, depth.texture, 0);\n        }\n    };\n\n    self.bind = function() {\n        gl.bindFramebuffer(gl.FRAMEBUFFER, self.fb);\n    }\n\n    self.initialize();\n\n};\n\nmodule.exports.Framebuffer = Framebuffer;\n\n\n//|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nfunction Texture(gl, index, data, width, height, options) {\n    options = options || {};\n    options.target = options.target || gl.TEXTURE_2D;\n    options.mag = options.mag || gl.NEAREST;\n    options.min = options.min || gl.NEAREST;\n    options.wraps = options.wraps || gl.CLAMP_TO_EDGE;\n    options.wrapt = options.wrapt || gl.CLAMP_TO_EDGE;\n    options.internalFormat = options.internalFormat || gl.RGBA;\n    options.format = options.format || gl.RGBA;\n    options.type = options.type || gl.UNSIGNED_BYTE;\n\n    var self = this;\n\n    self.initialize = function() {\n        self.index = index;\n        self.activate();\n        self.texture = gl.createTexture();\n        self.bind();\n        gl.texParameteri(options.target, gl.TEXTURE_MAG_FILTER, options.mag);\n        gl.texParameteri(options.target, gl.TEXTURE_MIN_FILTER, options.min);\n        gl.texParameteri(options.target, gl.TEXTURE_WRAP_S, options.wraps);\n        gl.texParameteri(options.target, gl.TEXTURE_WRAP_T, options.wrapt);\n        gl.texImage2D(options.target, 0, options.internalFormat, width, height, \n            0, options.format, options.type, data);\n    }\n\n    self.bind = function() {\n        gl.bindTexture(options.target, self.texture);\n    };\n\n    self.activate = function() {\n        gl.activeTexture(gl.TEXTURE0 + self.index);\n    };\n\n    self.reset = function() {\n        self.activate();\n        self.bind();\n        gl.texImage2D(options.target, 0, options.internalFormat, width, height, \n            0, options.format, options.type, data);\n    }\n\n    self.initialize();\n}\n\nmodule.exports.Texture = Texture;\n\n\n//|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nfunction GLBuffer(gl) {\n\n    var self = this;\n\n    self.initialize = function() {\n        self.buffer = gl.createBuffer();\n    }\n\n    self.bind = function() {\n        gl.bindBuffer(gl.ARRAY_BUFFER, self.buffer);\n    }\n\n    self.set = function(data) {\n        self.bind();\n        gl.bufferData(gl.ARRAY_BUFFER, data, gl.STATIC_DRAW);\n    }\n\n    self.initialize();\n};\n\nmodule.exports.GLBuffer = GLBuffer;\n\n\n//|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nfunction Renderable(gl, program, buffers, primitiveCount) {\n\n    var self = this;\n\n    self.primitiveCount = primitiveCount;\n\n    self.initialize = function() {\n    }\n\n    self.render = function() {\n        program.use();\n        for (let name in buffers) {\n            var buffer = buffers[name].buffer;\n            var size = buffers[name].size;\n            try {\n                var location = program.attribs[name].location;\n            } catch (e) {\n                console.log(\"Could not find location for\", name);\n                throw e;\n            }\n            buffer.bind();\n            gl.enableVertexAttribArray(location);\n            gl.vertexAttribPointer(location, size, gl.FLOAT, false, 0, 0);\n        }\n        gl.drawArrays(gl.TRIANGLES, 0, 3 * primitiveCount);\n        for (let name in self.buffers) {\n            gl.disableVertexAttribArray(program.attributes[name].location);\n        }\n    }\n\n    self.initialize();\n};\n\nmodule.exports.Renderable = Renderable;\n\n\n//|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nfunction InstancedRenderable(gl, program, buffers, primitiveCount, instancedExt) {\n\n    var self = this;\n\n    self.initialize = function() {\n    }\n\n    self.render = function() {\n        program.use();\n        for (let name in buffers) {\n            var buffer = buffers[name].buffer;\n            var size = buffers[name].size;\n            try {\n                var location = program.attribs[name].location;\n            } catch (e) {\n                console.log(\"Could not find location for\", name);\n                throw e;\n            }\n            buffer.bind();\n            gl.enableVertexAttribArray(location);\n            gl.vertexAttribPointer(location, size, gl.FLOAT, false, 0, 0);\n            instancedExt.vertexAttribDivisorANGLE(location, buffers[name].divisor);                \n        }\n        instancedExt.drawArraysInstancedANGLE(gl.TRIANGLES, 0, 6*2*3, primitiveCount)\n        for (let name in self.buffers) {\n            gl.disableVertexAttribArray(program.attributes[name].location);\n        }\n    }\n\n    self.initialize();\n};\n\nmodule.exports.InstancedRenderable = InstancedRenderable;\n\n\n//|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nfunction Program(gl, vertexSource, fragmentSource) {\n\n    var self = this;\n\n    self.initialize = function() {\n        self.program = self.compileProgram(vertexSource, fragmentSource);\n        self.attribs = self.gatherAttribs();\n        self.uniforms = self.gatherUniforms();\n    }\n\n    self.use = function() {\n        gl.useProgram(self.program);\n    }\n\n    self.compileProgram = function(vertexSource, fragmentSource) {\n        var vertexShader = self.compileShader(vertexSource, gl.VERTEX_SHADER);\n        var fragmentShader = self.compileShader(fragmentSource, gl.FRAGMENT_SHADER);\n        var program = gl.createProgram();\n        gl.attachShader(program, vertexShader);\n        gl.attachShader(program, fragmentShader);\n        gl.linkProgram(program);\n        if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n            console.log(gl.getProgramInfoLog(program));\n            throw \"Failed to compile program.\";\n        }\n        return program;\n    }\n\n    self.compileShader = function(source, type) {\n        var shader = gl.createShader(type);\n        gl.shaderSource(shader, source);\n        gl.compileShader(shader);\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n            var err = gl.getShaderInfoLog(shader);\n            var lineno = parseInt(err.split(':')[2]);\n            var split = source.split(\"\\n\");\n            for (var i in split) {\n                var q = parseInt(i);\n                console.log(q + \"  \" + split[i]);\n                if (i == lineno - 1) {\n                    console.warn(err);\n                }\n            }\n            let typeString = type == gl.VERTEX_SHADER ? \"vertex\" : \"fragment\";\n            throw \"Failed to compile \" + typeString + \" shader.\";\n        }\n        return shader;\n    }\n\n    self.setUniform = function(name, type, value) {\n        var args = Array.prototype.slice.call(arguments, 2);\n        self.use(); // Make this idempotent. At the context level, perhaps?\n        try {\n            var location = self.uniforms[name].location;\n        }\n        catch(e) {\n            console.log(name);\n            throw e;\n        }\n        gl['uniform' + type].apply(gl, [location].concat(args));\n    }\n\n    self.gatherUniforms = function() {\n        var uniforms = {};\n        var nUniforms = gl.getProgramParameter(self.program, gl.ACTIVE_UNIFORMS);\n        for (var i = 0; i < nUniforms; i++) {\n            var uniform = gl.getActiveUniform(self.program, i);\n            uniforms[uniform.name] = {\n                name: uniform.name,\n                location: gl.getUniformLocation(self.program, uniform.name),\n                type: uniform.type,\n                size: uniform.size\n            };\n        }\n        return uniforms;\n    }\n\n    self.gatherAttribs = function() {\n        var attribs = {};\n        var nAttribs = gl.getProgramParameter(self.program, gl.ACTIVE_ATTRIBUTES);\n        for (var i = 0; i < nAttribs; i++) {\n            var attrib = gl.getActiveAttrib(self.program, i);\n            attribs[attrib.name] = {\n                name: attrib.name,\n                location: gl.getAttribLocation(self.program, attrib.name),\n                type: attrib.type,\n                size: attrib.size\n            };\n        }\n        return attribs;\n    }   \n\n//|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\n    self.initialize();\n\n};\n\n//|||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||||\nmodule.exports.Program = Program;\n","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/const.js",["100"],"\"use strict\";\n\nvar elements = require(\"./elements\");\n\nvar MIN_ATOM_RADIUS = Infinity;\nvar MAX_ATOM_RADIUS = -Infinity;\nfor (var i = 0; i <= 118; i++) {\n    MIN_ATOM_RADIUS = Math.min(MIN_ATOM_RADIUS, elements[i].radius);\n    MAX_ATOM_RADIUS = Math.max(MAX_ATOM_RADIUS, elements[i].radius);\n}\n\nmodule.exports.MIN_ATOM_RADIUS = MIN_ATOM_RADIUS;\nmodule.exports.MAX_ATOM_RADIUS = MAX_ATOM_RADIUS;","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/gl-matrix.js",[],"/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/elements.js",[],"/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/shaders.js",["101","102","103","104","105","106","107","108","109"],"\"use strict\";\nvar shaders = {}; \nshaders [\"accumulator\"] = `#version 100\nprecision highp float;\n\nattribute vec3 aPosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 1);\n}\n\n\n// __split__\n\n\n#version 100\nprecision highp float;\n\nuniform sampler2D uSceneDepth;\nuniform sampler2D uSceneNormal;\nuniform sampler2D uRandRotDepth;\nuniform sampler2D uAccumulator;\nuniform mat4 uRot;\nuniform mat4 uInvRot;\nuniform vec2 uSceneBottomLeft;\nuniform vec2 uSceneTopRight;\nuniform vec2 uRotBottomLeft;\nuniform vec2 uRotTopRight;\nuniform float uDepth;\nuniform float uRes;\nuniform int uSampleCount;\n\nvoid main() {\n\n    float dScene = texture2D(uSceneDepth, gl_FragCoord.xy/uRes).r;\n\n    vec3 r = vec3(uSceneBottomLeft + (gl_FragCoord.xy/uRes) * (uSceneTopRight - uSceneBottomLeft), 0.0);\n\n    r.z = -(dScene - 0.5) * uDepth;\n    r = vec3(uRot * vec4(r, 1));\n    float depth = -r.z/uDepth + 0.5;\n\n    vec2 p = (r.xy - uRotBottomLeft)/(uRotTopRight - uRotBottomLeft);\n\n    float dRandRot = texture2D(uRandRotDepth, p).r;\n\n    float ao = step(dRandRot, depth * 0.99);\n\n    vec3 normal = texture2D(uSceneNormal, gl_FragCoord.xy/uRes).rgb * 2.0 - 1.0;\n    vec3 dir = vec3(uInvRot * vec4(0, 0, 1, 0));\n    float mag = dot(dir, normal);\n    float sampled = step(0.0, mag);\n\n    ao *= sampled;\n\n    vec4 acc = texture2D(uAccumulator, gl_FragCoord.xy/uRes);\n\n    if (uSampleCount < 256) {\n        acc.r += ao/255.0;\n    } else if (uSampleCount < 512) {\n        acc.g += ao/255.0;\n    } else if (uSampleCount < 768) {\n        acc.b += ao/255.0;\n    } else {\n        acc.a += ao/255.0;\n    }\n        \n    gl_FragColor = acc;\n\n}\n`; \nshaders [\"ao\"] = `#version 100\nprecision highp float;\n\nattribute vec3 aPosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 1);\n}\n\n\n// __split__\n\n\n#version 100\nprecision highp float;\n\nuniform sampler2D uSceneColor;\nuniform sampler2D uSceneDepth;\nuniform sampler2D uAccumulatorOut;\nuniform float uRes;\nuniform float uAO;\nuniform float uBrightness;\nuniform float uOutlineStrength;\n\nvoid main() {\n    vec2 p = gl_FragCoord.xy/uRes;\n    vec4 sceneColor = texture2D(uSceneColor, p);\n    if (uOutlineStrength > 0.0) {\n        float depth = texture2D(uSceneDepth, p).r;\n        float r = 1.0/511.0;\n        float d0 = abs(texture2D(uSceneDepth, p + vec2(-r,  0)).r - depth);\n        float d1 = abs(texture2D(uSceneDepth, p + vec2( r,  0)).r - depth);\n        float d2 = abs(texture2D(uSceneDepth, p + vec2( 0, -r)).r - depth);\n        float d3 = abs(texture2D(uSceneDepth, p + vec2( 0,  r)).r - depth);\n        float d = max(d0, d1);\n        d = max(d, d2);\n        d = max(d, d3);\n        sceneColor.rgb *= pow(1.0 - d, uOutlineStrength * 32.0);\n        sceneColor.a = max(step(0.003, d), sceneColor.a);\n    }\n    vec4 dAccum = texture2D(uAccumulatorOut, p);\n    float shade = max(0.0, 1.0 - (dAccum.r + dAccum.g + dAccum.b + dAccum.a) * 0.25 * uAO);\n    shade = pow(shade, 2.0);\n    gl_FragColor = vec4(uBrightness * sceneColor.rgb * shade, sceneColor.a);\n}\n`; \nshaders [\"atom\"] = `#version 100\nprecision highp float;\n\nattribute vec3 aImposter;\nattribute vec3 aPosition;\nattribute float aRadius;\nattribute vec3 aColor;\n\nuniform mat4 uView;\nuniform mat4 uProjection;\nuniform mat4 uModel;\nuniform float uAtomScale;\nuniform float uRelativeAtomScale;\nuniform float uAtomShade;\n\nvarying vec3 vColor;\nvarying vec3 vPosition;\nvarying float vRadius;\n\nvoid main() {\n    vRadius = uAtomScale * (1.0 + (aRadius - 1.0) * uRelativeAtomScale);\n    gl_Position = uProjection * uView * uModel * vec4(vRadius * aImposter + aPosition, 1.0);\n    vColor = mix(aColor, vec3(1,1,1), uAtomShade);\n    vPosition = vec3(uModel * vec4(aPosition, 1));\n}\n\n\n// __split__\n\n\n#version 100\n#extension GL_EXT_frag_depth: enable\nprecision highp float;\n\nuniform vec2 uBottomLeft;\nuniform vec2 uTopRight;\nuniform float uRes;\nuniform float uDepth;\nuniform int uMode;\n\nvarying vec3 vPosition;\nvarying float vRadius;\nvarying vec3 vColor;\n\nvec2 res = vec2(uRes, uRes);\n\nfloat raySphereIntersect(vec3 r0, vec3 rd) {\n    float a = dot(rd, rd);\n    vec3 s0_r0 = r0 - vPosition;\n    float b = 2.0 * dot(rd, s0_r0);\n    float c = dot(s0_r0, s0_r0) - (vRadius * vRadius);\n    float disc = b*b - 4.0*a*c;\n    if (disc <= 0.0) {\n        return -1.0;\n    }\n    return (-b - sqrt(disc))/(2.0*a);\n}\n\nvoid main() {\n    vec3 r0 = vec3(uBottomLeft + (gl_FragCoord.xy/res) * (uTopRight - uBottomLeft), 0.0);\n    vec3 rd = vec3(0, 0, -1);\n    float t = raySphereIntersect(r0, rd);\n    if (t < 0.0) {\n        discard;\n    }\n    vec3 coord = r0 + rd * t;\n    vec3 normal = normalize(coord - vPosition);\n    if (uMode == 0) {\n        gl_FragColor = vec4(vColor, 1);\n    } else if (uMode == 1) {\n        gl_FragColor = vec4(normal * 0.5 + 0.5, 1.0);\n    }\n    gl_FragDepthEXT = -coord.z/uDepth;\n}\n`; \nshaders [\"blur\"] = `#version 100\nprecision highp float;\n\nattribute vec3 aPosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 1);\n}\n\n\n// __split__\n\n\n#version 100\nprecision highp float;\n\nuniform sampler2D uTexture;\nuniform float uRes;\nuniform int leftRight;\n\nvoid main() {\n    vec2 dir;\n    if (leftRight == 1) {\n        dir = vec2(1,0)/uRes;\n    } else {\n        dir = vec2(0,1)/uRes;\n    }\n    const int range = 16;\n    vec4 sample = vec4(0,0,0,0);\n    for (int i = -range; i <= range; i++) {\n        vec2 p = gl_FragCoord.xy/uRes + dir * float(i);\n        sample += texture2D(uTexture, p);\n    }\n    sample /= float(range) * 2.0 + 1.0;\n    gl_FragColor = sample;\n}\n`; \nshaders [\"bond\"] = `#version 100\nprecision highp float;\n\nattribute vec3 aImposter;\nattribute vec3 aPosA;\nattribute vec3 aPosB;\nattribute float aRadA;\nattribute float aRadB;\nattribute vec3 aColA;\nattribute vec3 aColB;\n\nuniform mat4 uView;\nuniform mat4 uProjection;\nuniform mat4 uModel;\nuniform mat4 uRotation;\nuniform float uBondRadius;\nuniform float uAtomScale;\nuniform float uRelativeAtomScale;\n\nvarying vec3 vNormal;\nvarying vec3 vPosA, vPosB;\nvarying float vRadA, vRadB;\nvarying vec3 vColA, vColB;\nvarying float vRadius;\n\nmat3 alignVector(vec3 a, vec3 b) {\n    vec3 v = cross(a, b);\n    float s = length(v);\n    float c = dot(a, b);\n    mat3 I = mat3(\n        1, 0, 0,\n        0, 1, 0,\n        0, 0, 1\n    );\n    mat3 vx = mat3(\n        0, v.z, -v.y,\n        -v.z, 0, v.x,\n        v.y, -v.x, 0\n    );\n    return I + vx + vx * vx * ((1.0 - c) / (s * s));\n}\n\nvoid main() {\n    vRadius = uBondRadius;\n    vec3 pos = vec3(aImposter);\n    // Scale the box in x and z to be bond-radius.\n    pos = pos * vec3(vRadius, 1, vRadius);\n    // Shift the origin-centered cube so that the bottom is at the origin.\n    pos = pos + vec3(0, 1, 0);\n    // Stretch the box in y so that it is the length of the bond.\n    pos = pos * vec3(1, length(aPosA - aPosB) * 0.5, 1);\n    // Find the rotation that aligns vec3(0, 1, 0) with vec3(uPosB - uPosA) and apply it.\n    vec3 a = normalize(vec3(-0.000001, 1.000001, 0.000001));\n    vec3 b = normalize(aPosB - aPosA);\n    mat3 R = alignVector(a, b);\n    pos = R * pos;\n    // Shift the cube so that the bottom is centered at the middle of atom A.\n    pos = pos + aPosA;\n\n    vec4 position = uModel * vec4(pos, 1);\n    gl_Position = uProjection * uView * position;\n    vPosA = aPosA;\n    vPosB = aPosB;\n    vRadA = uAtomScale * (1.0 + (aRadA - 1.0) * uRelativeAtomScale);\n    vRadB = uAtomScale * (1.0 + (aRadB - 1.0) * uRelativeAtomScale);\n    vColA = aColA;\n    vColB = aColB;\n}\n\n\n// __split__\n\n\n#version 100\n#extension GL_EXT_frag_depth: enable\nprecision highp float;\n\nuniform mat4 uRotation;\nuniform vec2 uBottomLeft;\nuniform vec2 uTopRight;\nuniform float uDepth;\nuniform float uRes;\nuniform float uBondShade;\nuniform int uMode;\n\nvarying vec3 vPosA, vPosB;\nvarying float vRadA, vRadB;\nvarying vec3 vColA, vColB;\nvarying float vRadius;\n\nmat3 alignVector(vec3 a, vec3 b) {\n    vec3 v = cross(a, b);\n    float s = length(v);\n    float c = dot(a, b);\n    mat3 I = mat3(\n        1, 0, 0,\n        0, 1, 0,\n        0, 0, 1\n    );\n    mat3 vx = mat3(\n        0, v.z, -v.y,\n        -v.z, 0, v.x,\n        v.y, -v.x, 0\n    );\n    return I + vx + vx * vx * ((1.0 - c) / (s * s));\n}\n\nvoid main() {\n\n    vec2 res = vec2(uRes, uRes);\n    vec3 r0 = vec3(uBottomLeft + (gl_FragCoord.xy/res) * (uTopRight - uBottomLeft), uDepth/2.0);\n    vec3 rd = vec3(0, 0, -1);\n\n    vec3 i = normalize(vPosB - vPosA);\n         i = vec3(uRotation * vec4(i, 0));\n    vec3 j = normalize(vec3(-0.000001, 1.000001, 0.000001));\n    mat3 R = alignVector(i, j);\n\n    vec3 r0p = r0 - vec3(uRotation * vec4(vPosA, 0));\n    r0p = R * r0p;\n    vec3 rdp = R * rd;\n\n    float a = dot(rdp.xz, rdp.xz);\n    float b = 2.0 * dot(rdp.xz, r0p.xz);\n    float c = dot(r0p.xz, r0p.xz) - vRadius*vRadius;\n    float disc = b*b - 4.0*a*c;\n    if (disc <= 0.0) {\n        discard;\n    }\n    float t = (-b - sqrt(disc))/(2.0*a);\n    if (t < 0.0) {\n        discard;\n    }\n\n    vec3 coord = r0p + rdp * t;\n    if (coord.y < 0.0 || coord.y > length(vPosA - vPosB)) {\n        discard;\n    }\n\n    vec3 color;\n    if (coord.y < vRadA + 0.5 * (length(vPosA - vPosB) - (vRadA + vRadB))) {\n        color = vColA;\n    } else {\n        color = vColB;\n    }\n\n    color = mix(color, vec3(1,1,1), uBondShade);\n\n    R = alignVector(j, i);\n    vec3 normal = normalize(R * vec3(coord.x, 0, coord.z));\n\n    coord = r0 + rd * t;\n    if (uMode == 0) {\n        gl_FragColor = vec4(color, 1);\n    } else if (uMode == 1) {\n        gl_FragColor = vec4(normal * 0.5 + 0.5, 1.0);\n    }\n    gl_FragDepthEXT = -(coord.z - uDepth/2.0)/uDepth;\n}\n`; \nshaders [\"dof\"] = `#version 100\nprecision highp float;\n\nattribute vec3 aPosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 1);\n}\n\n\n// __split__\n\n\n#version 100\nprecision highp float;\n\nuniform sampler2D uColor;\nuniform sampler2D uDepth;\nuniform float uRes;\nuniform float uDOFPosition;\nuniform float uDOFStrength;\nuniform int leftRight;\n\nvoid main() {\n\n    vec2 samples[64];\n    samples[0] = vec2(0.857612, 0.019885);\n    samples[1] = vec2(0.563809, -0.028071);\n    samples[2] = vec2(0.825599, -0.346856);\n    samples[3] = vec2(0.126584, -0.380959);\n    samples[4] = vec2(0.782948, 0.594322);\n    samples[5] = vec2(0.292148, -0.543265);\n    samples[6] = vec2(0.130700, 0.330220);\n    samples[7] = vec2(0.236088, 0.159604);\n    samples[8] = vec2(-0.305259, 0.810505);\n    samples[9] = vec2(0.269616, 0.923026);\n    samples[10] = vec2(0.484486, 0.371845);\n    samples[11] = vec2(-0.638057, 0.080447);\n    samples[12] = vec2(0.199629, 0.667280);\n    samples[13] = vec2(-0.861043, -0.370583);\n    samples[14] = vec2(-0.040652, -0.996174);\n    samples[15] = vec2(0.330458, -0.282111);\n    samples[16] = vec2(0.647795, -0.214354);\n    samples[17] = vec2(0.030422, -0.189908);\n    samples[18] = vec2(0.177430, -0.721124);\n    samples[19] = vec2(-0.461163, -0.327434);\n    samples[20] = vec2(-0.410012, -0.734504);\n    samples[21] = vec2(-0.616334, -0.626069);\n    samples[22] = vec2(0.590759, -0.726479);\n    samples[23] = vec2(-0.590794, 0.805365);\n    samples[24] = vec2(-0.924561, -0.163739);\n    samples[25] = vec2(-0.323028, 0.526960);\n    samples[26] = vec2(0.642128, 0.752577);\n    samples[27] = vec2(0.173625, -0.952386);\n    samples[28] = vec2(0.759014, 0.330311);\n    samples[29] = vec2(-0.360526, -0.032013);\n    samples[30] = vec2(-0.035320, 0.968156);\n    samples[31] = vec2(0.585478, -0.431068);\n    samples[32] = vec2(-0.244766, -0.906947);\n    samples[33] = vec2(-0.853096, 0.184615);\n    samples[34] = vec2(-0.089061, 0.104648);\n    samples[35] = vec2(-0.437613, 0.285308);\n    samples[36] = vec2(-0.654098, 0.379841);\n    samples[37] = vec2(-0.128663, 0.456572);\n    samples[38] = vec2(0.015980, -0.568170);\n    samples[39] = vec2(-0.043966, -0.771940);\n    samples[40] = vec2(0.346512, -0.071238);\n    samples[41] = vec2(-0.207921, -0.209121);\n    samples[42] = vec2(-0.624075, -0.189224);\n    samples[43] = vec2(-0.120618, 0.689339);\n    samples[44] = vec2(-0.664679, -0.410200);\n    samples[45] = vec2(0.371945, -0.880573);\n    samples[46] = vec2(-0.743251, 0.629998);\n    samples[47] = vec2(-0.191926, -0.413946);\n    samples[48] = vec2(0.449574, 0.833373);\n    samples[49] = vec2(0.299587, 0.449113);\n    samples[50] = vec2(-0.900432, 0.399319);\n    samples[51] = vec2(0.762613, -0.544796);\n    samples[52] = vec2(0.606462, 0.174233);\n    samples[53] = vec2(0.962185, -0.167019);\n    samples[54] = vec2(0.960990, 0.249552);\n    samples[55] = vec2(0.570397, 0.559146);\n    samples[56] = vec2(-0.537514, 0.555019);\n    samples[57] = vec2(0.108491, -0.003232);\n    samples[58] = vec2(-0.237693, -0.615428);\n    samples[59] = vec2(-0.217313, 0.261084);\n    samples[60] = vec2(-0.998966, 0.025692);\n    samples[61] = vec2(-0.418554, -0.527508);\n    samples[62] = vec2(-0.822629, -0.567797);\n    samples[63] = vec2(0.061945, 0.522105);\n\n    float invRes = 1.0/uRes;\n    vec2 coord = gl_FragCoord.xy * invRes;\n\n    float strength = uDOFStrength * uRes/768.0;\n\n    float depth = texture2D(uDepth, coord).r;\n    float range = uDOFPosition - depth;\n    float scale = abs(range);\n\n    vec4 sample = texture2D(uColor, coord);\n    float count = 1.0;\n    for(int i = 0; i < 64; i++) {\n        vec2 p = samples[i];\n        p = coord + scale * 64.0 * strength * p * invRes;\n        float d = texture2D(uDepth, p).r;\n        float r = uDOFPosition - d;\n        float s = abs(r);\n        sample += texture2D(uColor, p) * s;\n        count += s;\n    }\n\n    gl_FragColor = sample/count;\n}`; \nshaders [\"fxaa\"] = `#version 100\nprecision highp float;\n\nattribute vec3 aPosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 1);\n}\n\n\n// __split__\n\n\n#version 100\nprecision highp float;\n\nuniform sampler2D uTexture;\nuniform float uRes;\n\nvoid main() {\n    float FXAA_SPAN_MAX = 8.0;\n    float FXAA_REDUCE_MUL = 1.0/8.0;\n    float FXAA_REDUCE_MIN = 1.0/128.0;\n\n    vec2 texCoords = gl_FragCoord.xy/uRes;\n\n    vec4 rgbNW = texture2D(uTexture, texCoords + (vec2(-1.0, -1.0) / uRes));\n    vec4 rgbNE = texture2D(uTexture, texCoords + (vec2(1.0, -1.0) / uRes));\n    vec4 rgbSW = texture2D(uTexture, texCoords + (vec2(-1.0, 1.0) / uRes));\n    vec4 rgbSE = texture2D(uTexture, texCoords + (vec2(1.0, 1.0) / uRes));\n    vec4 rgbM  = texture2D(uTexture, texCoords);\n\n    vec4 luma = vec4(0.299, 0.587, 0.114, 1.0);\n    float lumaNW = dot(rgbNW, luma);\n    float lumaNE = dot(rgbNE, luma);\n    float lumaSW = dot(rgbSW, luma);\n    float lumaSE = dot(rgbSE, luma);\n    float lumaM  = dot(rgbM,  luma);\n\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    vec2 dir;\n    dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));\n    dir.y =  ((lumaNW + lumaSW) - (lumaNE + lumaSE));\n\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n\n    float rcpDirMin = 1.0/(min(abs(dir.x), abs(dir.y)) + dirReduce);\n\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX), max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)) / uRes;\n\n    vec4 rgbA = (1.0/2.0) * \n        (texture2D(uTexture, texCoords.xy + dir * (1.0/3.0 - 0.5)) + \n         texture2D(uTexture, texCoords.xy + dir * (2.0/3.0 - 0.5)));\n    vec4 rgbB = rgbA * (1.0/2.0) + (1.0/4.0) * \n        (texture2D(uTexture, texCoords.xy + dir * (0.0/3.0 - 0.5)) +\n         texture2D(uTexture, texCoords.xy + dir * (3.0/3.0 - 0.5)));\n    float lumaB = dot(rgbB, luma);\n\n    if((lumaB < lumaMin) || (lumaB > lumaMax)){\n        gl_FragColor = rgbA;\n    } else {\n        gl_FragColor = rgbB;\n    }\n\n}`; \nshaders [\"textured-quad\"] = `#version 100\nprecision highp float;\n\nattribute vec3 aPosition;\n\nvoid main() {\n    gl_Position = vec4(aPosition, 1);\n}\n\n\n// __split__\n\n\n#version 100\nprecision highp float;\n\nuniform sampler2D uTexture;\nuniform float uRes;\n\nvoid main() {\n    gl_FragColor = texture2D(uTexture, gl_FragCoord.xy/uRes);\n}\n`; \nmodule.exports = {shaders};\n","/Users/denphi/Documents/Github/speck/widget/ipyspeck/ipyspeck/stspeck/frontend/src/cube.js",[],{"ruleId":"110","severity":1,"message":"111","line":1,"column":21,"nodeType":"112","messageId":"113","endLine":1,"endColumn":31},{"ruleId":"114","severity":1,"message":"115","line":1,"column":1,"nodeType":"116","messageId":"117","endLine":1,"endColumn":14,"fix":"118"},{"ruleId":"119","severity":1,"message":"120","line":13,"column":5,"nodeType":"112","messageId":"113","endLine":13,"endColumn":12},{"ruleId":"119","severity":1,"message":"121","line":43,"column":5,"nodeType":"112","messageId":"113","endLine":43,"endColumn":11},{"ruleId":"119","severity":1,"message":"122","line":73,"column":5,"nodeType":"112","messageId":"113","endLine":73,"endColumn":13},{"ruleId":"119","severity":1,"message":"123","line":81,"column":5,"nodeType":"112","messageId":"113","endLine":81,"endColumn":10},{"ruleId":"119","severity":1,"message":"124","line":113,"column":5,"nodeType":"112","messageId":"113","endLine":113,"endColumn":14},{"ruleId":"119","severity":1,"message":"125","line":120,"column":5,"nodeType":"112","messageId":"113","endLine":120,"endColumn":11},{"ruleId":"119","severity":1,"message":"126","line":131,"column":5,"nodeType":"112","messageId":"113","endLine":131,"endColumn":12},{"ruleId":"119","severity":1,"message":"127","line":142,"column":5,"nodeType":"112","messageId":"113","endLine":142,"endColumn":12},{"ruleId":"119","severity":1,"message":"128","line":153,"column":5,"nodeType":"112","messageId":"113","endLine":153,"endColumn":12},{"ruleId":"119","severity":1,"message":"129","line":165,"column":5,"nodeType":"112","messageId":"113","endLine":165,"endColumn":12},{"ruleId":"119","severity":1,"message":"130","line":181,"column":5,"nodeType":"112","messageId":"113","endLine":181,"endColumn":18},{"ruleId":"114","severity":1,"message":"115","line":1,"column":1,"nodeType":"116","messageId":"117","endLine":1,"endColumn":14,"fix":"131"},{"ruleId":"132","severity":1,"message":"133","line":7,"column":9,"nodeType":"134","messageId":"135","endLine":7,"endColumn":67},{"ruleId":"132","severity":1,"message":"133","line":10,"column":9,"nodeType":"134","messageId":"135","endLine":10,"endColumn":63},{"ruleId":"114","severity":1,"message":"115","line":1,"column":1,"nodeType":"116","messageId":"117","endLine":1,"endColumn":14,"fix":"136"},{"ruleId":"119","severity":1,"message":"137","line":8,"column":5,"nodeType":"112","messageId":"113","endLine":8,"endColumn":14},{"ruleId":"119","severity":1,"message":"138","line":16,"column":5,"nodeType":"112","messageId":"113","endLine":16,"endColumn":19},{"ruleId":"139","severity":1,"message":"140","line":18,"column":11,"nodeType":"141","messageId":"142","endLine":18,"endColumn":13},{"ruleId":"119","severity":1,"message":"143","line":72,"column":5,"nodeType":"112","messageId":"113","endLine":72,"endColumn":12},{"ruleId":"119","severity":1,"message":"121","line":97,"column":5,"nodeType":"112","messageId":"113","endLine":97,"endColumn":11},{"ruleId":"139","severity":1,"message":"140","line":112,"column":11,"nodeType":"141","messageId":"142","endLine":112,"endColumn":13},{"ruleId":"119","severity":1,"message":"144","line":130,"column":5,"nodeType":"112","messageId":"113","endLine":130,"endColumn":14},{"ruleId":"114","severity":1,"message":"115","line":1,"column":1,"nodeType":"116","messageId":"117","endLine":1,"endColumn":14,"fix":"145"},{"ruleId":"119","severity":1,"message":"146","line":6,"column":5,"nodeType":"112","messageId":"113","endLine":6,"endColumn":13},{"ruleId":"119","severity":1,"message":"147","line":16,"column":13,"nodeType":"112","messageId":"113","endLine":16,"endColumn":20},{"ruleId":"148","severity":1,"message":"149","line":20,"column":13,"nodeType":"112","messageId":"150","endLine":20,"endColumn":19},{"ruleId":"119","severity":1,"message":"151","line":24,"column":13,"nodeType":"112","messageId":"113","endLine":24,"endColumn":22},{"ruleId":"119","severity":1,"message":"152","line":41,"column":13,"nodeType":"112","messageId":"113","endLine":41,"endColumn":18},{"ruleId":"119","severity":1,"message":"153","line":52,"column":13,"nodeType":"112","messageId":"113","endLine":52,"endColumn":16},{"ruleId":"148","severity":1,"message":"154","line":220,"column":25,"nodeType":"112","messageId":"150","endLine":220,"endColumn":32},{"ruleId":"148","severity":1,"message":"155","line":230,"column":25,"nodeType":"112","messageId":"150","endLine":230,"endColumn":33},{"ruleId":"148","severity":1,"message":"156","line":238,"column":30,"nodeType":"112","messageId":"150","endLine":238,"endColumn":31},{"ruleId":"148","severity":1,"message":"157","line":258,"column":25,"nodeType":"112","messageId":"150","endLine":258,"endColumn":30},{"ruleId":"139","severity":1,"message":"158","line":496,"column":27,"nodeType":"141","messageId":"142","endLine":496,"endColumn":29},{"ruleId":"132","severity":1,"message":"133","line":23,"column":13,"nodeType":"134","messageId":"135","endLine":23,"endColumn":66},{"ruleId":"148","severity":1,"message":"156","line":47,"column":22,"nodeType":"112","messageId":"150","endLine":47,"endColumn":23},{"ruleId":"132","severity":1,"message":"133","line":239,"column":13,"nodeType":"134","messageId":"135","endLine":239,"endColumn":48},{"ruleId":"139","severity":1,"message":"158","line":255,"column":23,"nodeType":"141","messageId":"142","endLine":255,"endColumn":25},{"ruleId":"139","severity":1,"message":"158","line":259,"column":35,"nodeType":"141","messageId":"142","endLine":259,"endColumn":37},{"ruleId":"132","severity":1,"message":"133","line":260,"column":13,"nodeType":"134","messageId":"135","endLine":260,"endColumn":66},{"ruleId":"114","severity":1,"message":"115","line":1,"column":1,"nodeType":"116","messageId":"117","endLine":1,"endColumn":14,"fix":"159"},{"ruleId":"114","severity":1,"message":"115","line":1,"column":1,"nodeType":"116","messageId":"117","endLine":1,"endColumn":14,"fix":"160"},{"ruleId":"161","severity":1,"message":"162","line":3,"column":1,"nodeType":"163","messageId":"164","endLine":3,"endColumn":24,"fix":"165"},{"ruleId":"161","severity":1,"message":"166","line":72,"column":1,"nodeType":"163","messageId":"164","endLine":72,"endColumn":15,"fix":"167"},{"ruleId":"161","severity":1,"message":"168","line":118,"column":1,"nodeType":"163","messageId":"164","endLine":118,"endColumn":17,"fix":"169"},{"ruleId":"161","severity":1,"message":"170","line":193,"column":1,"nodeType":"163","messageId":"164","endLine":193,"endColumn":17,"fix":"171"},{"ruleId":"161","severity":1,"message":"172","line":230,"column":1,"nodeType":"163","messageId":"164","endLine":230,"endColumn":17,"fix":"173"},{"ruleId":"161","severity":1,"message":"174","line":390,"column":1,"nodeType":"163","messageId":"164","endLine":390,"endColumn":16,"fix":"175"},{"ruleId":"161","severity":1,"message":"176","line":504,"column":1,"nodeType":"163","messageId":"164","endLine":504,"endColumn":17,"fix":"177"},{"ruleId":"161","severity":1,"message":"178","line":571,"column":1,"nodeType":"163","messageId":"164","endLine":571,"endColumn":26,"fix":"179"},"@typescript-eslint/no-unused-vars","'RenderData' is defined but never used.","Identifier","unusedVar","strict","'use strict' is unnecessary inside of modules.","ExpressionStatement","module",{"range":"180","text":"181"},"no-unused-vars","'newView' is assigned a value but never used.","'center' is assigned a value but never used.","'override' is assigned a value but never used.","'clone' is assigned a value but never used.","'translate' is assigned a value but never used.","'rotate' is assigned a value but never used.","'rotateX' is assigned a value but never used.","'rotateY' is assigned a value but never used.","'rotateZ' is assigned a value but never used.","'getRect' is assigned a value but never used.","'getBondRadius' is assigned a value but never used.",{"range":"182","text":"181"},"no-throw-literal","Expected an error object to be thrown.","ThrowStatement","object",{"range":"183","text":"181"},"'newSystem' is assigned a value but never used.","'calculateBonds' is assigned a value but never used.","eqeqeq","Expected '!==' and instead saw '!='.","BinaryExpression","unexpected","'addAtom' is assigned a value but never used.","'getRadius' is assigned a value but never used.",{"range":"184","text":"181"},"'elements' is assigned a value but never used.","'samples' is assigned a value but never used.","no-redeclare","'canvas' is already defined.","redeclared","'rDispQuad' is assigned a value but never used.","'fbDOF' is assigned a value but never used.","'ext' is assigned a value but never used.","'attribs' is already defined.","'imposter' is already defined.","'i' is already defined.","'count' is already defined.","Expected '===' and instead saw '=='.",{"range":"185","text":"181"},{"range":"186","text":"181"},"no-whitespace-before-property","Unexpected whitespace before property \"accumulator\".","MemberExpression","unexpectedWhitespace",{"range":"187","text":"181"},"Unexpected whitespace before property \"ao\".",{"range":"188","text":"181"},"Unexpected whitespace before property \"atom\".",{"range":"189","text":"181"},"Unexpected whitespace before property \"blur\".",{"range":"190","text":"181"},"Unexpected whitespace before property \"bond\".",{"range":"191","text":"181"},"Unexpected whitespace before property \"dof\".",{"range":"192","text":"181"},"Unexpected whitespace before property \"fxaa\".",{"range":"193","text":"181"},"Unexpected whitespace before property \"textured-quad\".",{"range":"194","text":"181"},[0,13],"",[0,13],[0,13],[0,13],[0,13],[0,13],[40,41],[1614,1615],[2977,2978],[4755,4756],[5432,5433],[9422,9423],[13314,13315],[15410,15411]]